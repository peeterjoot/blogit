%
% Copyright © 2025 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
\input{../latex/blogpost.tex}
\renewcommand{\basename}{waveEquationGreens}
%\renewcommand{\dirname}{notes/phy1520/}
\renewcommand{\dirname}{notes/ece1228-electromagnetic-theory/}
%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{}

\input{../latex/peeter_prologue_print2.tex}

\usepackage{peeters_layout_exercise}
\usepackage{peeters_braket}
\usepackage{peeters_figures}
\usepackage{siunitx}
\usepackage{verbatim}
%\usepackage{macros_cal} % \LL
%\usepackage{amsthm} % proof
%\usepackage{mhchem} % \ce{}
%\usepackage{macros_bm} % \bcM
%\usepackage{macros_qed} % \qedmarker
%\usepackage{txfonts} % \ointclockwise

\beginArtNoToc

\generatetitle{Green's function for the wave equation}
%\chapter{Green's function for the wave equation}
%\label{chap:waveEquationGreens}
The Green's function(s) \( G(\Br, \tau) \) for the 3D wave equation
\begin{equation}\label{eqn:waveEquationGreens:40}
\lr{ \spacegrad^2 - \inv{c^2}\frac{\partial^2}{\partial t^2} } G(\Br, \tau) = \delta(\Br) \delta(\tau),
\end{equation}
where
\begin{equation}\label{eqn:waveEquationGreens:20}
\begin{aligned}
\Br &= \Bx - \Bx' \\
r &= \Abs{\Br} \\
\tau &= t - t',
\end{aligned}
\end{equation}
is
\begin{equation}\label{eqn:waveEquationGreens:60}
G(\Br, \tau) = -\inv{4 \pi r} \delta( \pm \tau - r/c ).
\end{equation}
Here the positive case is the retarded solution, and negative the advanced solution.  The derivation of these Green's functions can be found derived in many places, including \citep{byron1992mca}, \citep{jackson1975cew}, and \citep{schwinger1998classical}

I wasn't familiar with the 1D and 2D Green's functions for the wave equation.  Grok says they are, respectively
\begin{equation}\label{eqn:waveEquationGreens:80}
\begin{aligned}
G(\Br, \tau) &= -\frac{c}{2} \Theta( \pm \tau - r/c ) \\
G(\Br, \tau) &= -\inv{2 \pi \sqrt{ \tau^2 - r^2/c^2 } } \Theta( \pm \tau - r/c ).
\end{aligned}
\end{equation}
I'm not going to try to derive these myself, at least for the time being.  Instead, let's verify that they work, starting with the retarded 1D case.
\section{1D Green's function verification.}
We will use the Heaviside theta representation of the absolute value.
\begin{equation}\label{eqn:waveEquationGreens:100}
\Abs{x} = x \Theta(x) - x \Theta(-x).
\end{equation}
Recall that the derivative of the absolute value function is a sign function
\begin{equation}\label{eqn:waveEquationGreens:120}
\begin{aligned}
\Abs{x}'
&= \Theta(x) - \Theta(-x) + x \delta(x) + x \delta(-x) \\
&= \Theta(x) - \Theta(-x) + 2 x \delta(x) \\
&= \Theta(x) - \Theta(-x) \\
&= \sgn(x),
\end{aligned}
\end{equation}
where \( x \delta(x) \) is zero in a distributional sense (zero if applied to a test function.)
\begin{equation}\label{eqn:waveEquationGreens:140}
\begin{aligned}
\sgn(x)'
&= \Theta(x)' - \Theta(-x)' \\
&= \delta(x) + \delta(-x) \\
&= 2 \delta(x).
\end{aligned}
\end{equation}

Now let's evaluate the \( x \) partials.
\begin{equation}\label{eqn:waveEquationGreens:160}
\begin{aligned}
\PD{x}{} \Theta(\tau - r/c)
&=
-\inv{c} \delta\lr{ \tau - r/c } \PD{x}{} \Abs{x - x'} \\
&=
-\inv{c} \delta\lr{ \tau - r/c } \sgn(x - x').
\end{aligned}
\end{equation}
The second derivative is
\begin{equation}\label{eqn:waveEquationGreens:180}
\begin{aligned}
\frac{\partial^2}{\partial x^2} \Theta(\tau - r/c)
&=
-\inv{c}
\lr{
    -\inv{c} \delta'\lr{ \tau - r/c } (\sgn(x - x'))^2
    +
    \delta\lr{ \tau - r/c } 2 \delta(x - x')
} \\
&=
\inv{c^2} \delta'\lr{ \tau - r/c } - \frac{2}{c} \delta\lr{ \tau} \delta(x - x').
\end{aligned}
\end{equation}
The transformation above from \( \delta\lr{ \tau - r/c } \rightarrow \delta(\tau) \) is because the spatial delta function \( \delta(x - x') \) is zero unless \( x = x' \), and \( r = 0 \) at that point.

The time derivatives are easier to compute
\begin{equation}\label{eqn:waveEquationGreens:200}
\begin{aligned}
\frac{\partial^2}{\partial t^2} \Theta(\tau - r/c)
&=
\PD{t}{} \delta(\tau - r/c) \\
&=
\delta'(\tau - r/c).
\end{aligned}
\end{equation}

Putting the pieces together, we have
\begin{equation}\label{eqn:waveEquationGreens:220}
\begin{aligned}
\lr{ \spacegrad^2 - \inv{c^2}\frac{\partial^2}{\partial t^2} } \Theta(\tau - r/c)
&=
\inv{c^2} \delta'\lr{ \tau - r/c } - \frac{2}{c} \delta\lr{ \tau} \delta(x - x')
- \inv{c^2} \delta'(\tau - r/c)
\\
&=
- \frac{2}{c} \delta\lr{ \tau} \delta(x - x').
\end{aligned}
\end{equation}
Dividing through by \( -2/c \) gives us
\begin{equation}\label{eqn:waveEquationGreens:240}
\lr{ \spacegrad^2 - \inv{c^2}\frac{\partial^2}{\partial t^2} } G(\Bx - \Bx', t - t') = \delta\lr{t - t'} \delta\lr{\Bx - \Bx'},
\end{equation}
as desired.  The \( \delta \) derivative terms can be given meaning, but they conveniently cancel out, so we don't have to think about that this time.

It's easy to see that the advanced Green's function has the same behaviour, since the two time partials will bring down a factor of \( (\pm 1)^2 = 1 \) in general, which does not change anything above.
\section{2D Green's function verification.}
Now let's try to verify Grok's claim for the 2D Green's function, starting with a few helpful side calculations.

\begin{equation}\label{eqn:waveEquationGreens:260}
\begin{aligned}
\spacegrad \Abs{r}
&= \Be_m \partial_m \sqrt{ \sum_n \lr{x_n - x_n'}^2 } \\
&= \inv{2} 2 \frac{\Bx - \Bx'}{\Abs{\Bx - \Bx'}} \\
&= \rcap
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:waveEquationGreens:280}
\begin{aligned}
\spacegrad \lr{ \tau^2 - r^2/c^2 }^{-1/2}
&=
-\inv{2} \lr{ \tau^2 - r^2/c^2 }^{-3/2} \lr{-\frac{2 r}{c^2}} \spacegrad r \\
&=
-\inv{2} \lr{ \tau^2 - r^2/c^2 }^{-3/2} \lr{-\frac{2 r}{c^2}} \rcap \\
&=
\frac{r}{c^2} \lr{ \tau^2 - r^2/c^2 }^{-3/2} \rcap.
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:waveEquationGreens:300}
\begin{aligned}
\spacegrad \lr{ \tau^2 - r^2/c^2 }^{-3/2}
&=
-\frac{3}{2} \lr{ \tau^2 - r^2/c^2 }^{-5/2} \lr{-\frac{2 r}{c^2}} \spacegrad r \\
&=
-\frac{3}{2} \lr{ \tau^2 - r^2/c^2 }^{-5/2} \lr{-\frac{2 r}{c^2}} \rcap \\
&=
\frac{3 r}{c^2} \lr{ \tau^2 - r^2/c^2 }^{-5/2} \rcap.
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:waveEquationGreens:320}
\begin{aligned}
\spacegrad \Theta\lr{ \pm \tau - r/c }
&=
-\inv{c} \delta\lr{ \pm \tau - r/c } \spacegrad r \\
&=
-\inv{c} \delta\lr{ \pm \tau - r/c } \rcap.
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:waveEquationGreens:340}
\begin{aligned}
\spacegrad \delta\lr{ \pm \tau - r/c }
&=
-\inv{c} \delta'\lr{ \pm \tau - r/c } \spacegrad r \\
&=
-\inv{c} \delta'\lr{ \pm \tau - r/c } \rcap.
\end{aligned}
\end{equation}

\begin{equation}\label{eqn:waveEquationGreens:360}
\begin{aligned}
\spacegrad \cdot \rcap
&=
\spacegrad \cdot \frac{\Bx - \Bx'}{r} \\
&=
\inv{r} \spacegrad \cdot \lr{\Bx - \Bx'} + \lr{\Bx - \Bx'} \cdot \spacegrad \inv{r} \\
&=
\frac{2}{r} + \lr{\Bx - \Bx'} \cdot \lr{ -\inv{r^2} \rcap } \\
&=
\frac{2}{r} - \inv{r} \\
&=
\frac{1}{r},
\end{aligned}
\end{equation}
or, in summary, with \( X = \tau^2 - r^2/c^2 \)
\begin{equation}\label{eqn:waveEquationGreens:540}
\begin{aligned}
\spacegrad \Abs{r} &= \rcap \\
\spacegrad X^{-1/2} &= \inv{c^2} r \rcap X^{-3/2} \\
\spacegrad X^{-3/2} &= \inv{c^2} 3 r \rcap X^{-5/2} \\
\spacegrad \Theta &= - \inv{c} \delta \rcap \\
\spacegrad \delta &= - \inv{c} \rcap \delta' \\
\spacegrad \cdot \rcap &= \frac{1}{r}.
\end{aligned}
\end{equation}

We want a couple helper Laplacians too
\begin{equation}\label{eqn:waveEquationGreens:580}
\begin{aligned}
\spacegrad^2 X^{-1/2}
&=
\spacegrad \cdot \lr{ \inv{c^2} r \rcap X^{-3/2} } \\
&=
  \inv{c^2} \lr{ \spacegrad \cdot \rcap} \lr{ r X^{-3/2} }
+ \inv{c^2} \lr{ \rcap \cdot \spacegrad r } X^{-3/2}
+ \frac{r}{c^2} \lr{ \rcap \cdot \spacegrad  X^{-3/2} } \\
&=
  \inv{c^2} X^{-3/2}
+ \inv{c^2} X^{-3/2}
+ \frac{r}{c^2} \lr{ \inv{c^2} 3 r X^{-5/2} } \\
&=
  \frac{2}{c^2} X^{-3/2}
+ \frac{3 r^2}{c^4} X^{-5/2} \\
\end{aligned}
\end{equation}

The Laplacian of the step is
\begin{equation}\label{eqn:waveEquationGreens:600}
\begin{aligned}
\spacegrad^2 \Theta
&=
\spacegrad \cdot \lr{ - \inv{c} \delta \rcap } \\
&=
-\inv{c}
\lr{ \spacegrad \cdot \rcap } \delta
-\inv{c}
\rcap \cdot \spacegrad \delta \\
&=
-\inv{r c} \delta
-\inv{c}
\rcap \cdot \lr{
- \inv{c} \rcap \delta'
}
&=
-\inv{r c} \delta
+\inv{c^2} \delta'
\end{aligned}
\end{equation}

We are now ready to compute the Laplacian of \( \Theta X^{-1/2} \).  Let's precompute the chain rule for that, so that the rest of the job is just algebra
\begin{equation}\label{eqn:waveEquationGreens:620}
\begin{aligned}
\spacegrad^2 \lr{ f g }
&=
\spacegrad \cdot \lr{ f \spacegrad g }
+
\spacegrad \cdot \lr{ g \spacegrad f } \\
&=
f \spacegrad^2 g + \spacegrad f \cdot \spacegrad g
+
g \spacegrad^2 f + \spacegrad g \cdot \spacegrad f \\
&=
f \spacegrad^2 g + 2 \spacegrad f \cdot \spacegrad g + g \spacegrad^2 f.
\end{aligned}
\end{equation}
We want to sub in
\begin{equation}\label{eqn:waveEquationGreens:640}
\begin{aligned}
\spacegrad^2 \Theta &= -\inv{r c} \delta +\inv{c^2} \delta' \\
\spacegrad^2 X^{-1/2} &= \frac{2}{c^2} X^{-3/2} + \frac{3 r^2}{c^4} X^{-5/2} \\
\spacegrad X^{-1/2} &= \inv{c^2} r \rcap X^{-3/2} \\
\spacegrad \Theta &= - \inv{c} \delta \rcap.
\end{aligned}
\end{equation}
We get
\begin{equation}\label{eqn:waveEquationGreens:660}
\begin{aligned}
\spacegrad^2 \lr{ \Theta X^{-1/2} }
&=
\lr{ -\inv{r c} \delta +\inv{c^2} \delta' } X^{-1/2}
+ \lr{ \frac{2}{c^2} X^{-3/2} + \frac{3 r^2}{c^4} X^{-5/2} } \Theta
- 2  \inv{c^2} r X^{-3/2} \inv{c} \delta \\
&=
\inv{c^2} X^{-1/2} \delta'
+ \inv{c^2} \lr{ 2  \lr{\tau^2 - r^2/c^2}  + \frac{3 r^2}{c^2} } X^{-5/2} \Theta
- \inv{r c} \lr{  \tau^2 - r^2/c^2 + 2 r^2/c^2 } X^{-3/2} \delta \\
&=
\inv{c^2} X^{-1/2} \delta'
+ \inv{c^2} \lr{ 2 \tau^2 + \frac{r^2}{c^2} } X^{-5/2} \Theta
- \inv{r c} \lr{  \tau^2 + \frac{r^2}{c^2} } X^{-3/2} \delta
\end{aligned}
\end{equation}

We are ready to evaluate the time derivatives now.  Let's try it the same way with
\begin{equation}\label{eqn:waveEquationGreens:680}
\begin{aligned}
\partial_{tt} \lr{ f g }
&=
\partial_t \lr{ f \partial_t g + g \partial_t f } \\
&=
g \partial_{tt} f
+
f \partial_{tt} g
+ 2 \lr{ \partial_t f } \lr{ \partial_t g }.
\end{aligned}
\end{equation}

%}
\EndArticle
