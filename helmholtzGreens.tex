%
% Copyright © 2025 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
\input{../latex/blogpost.tex}
\renewcommand{\basename}{helmholtzGreens}
%\renewcommand{\dirname}{notes/phy1520/}
\renewcommand{\dirname}{notes/ece1228-electromagnetic-theory/}
%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{}

\input{../latex/peeter_prologue_print2.tex}

\usepackage{peeters_layout_exercise}
\usepackage{peeters_braket}
\usepackage{peeters_figures}
\usepackage{siunitx}
\usepackage{verbatim}
%\usepackage{macros_cal} % \LL
%\usepackage{amsthm} % proof
%\usepackage{mhchem} % \ce{}
%\usepackage{macros_bm} % \bcM
%\usepackage{macros_qed} % \qedmarker
%\usepackage{txfonts} % \ointclockwise

\beginArtNoToc

\generatetitle{Green's functions for the Helmholtz (wave equation) operator, and Laplacian, in low dimensions}
%\chapter{Green's functions for the Helmholtz (wave equation) operator in various dimensions}
%\label{chap:helmholtzGreens}
The great mathematical physics book \citep{byron1992mca} derives the Green's function for the 3D Helmholtz (wave equation in the frequency domain) operator.  It turns out that unless you are are intimate with Bessel functions, the 2D generalization of that result is difficult.

Here I'll walk through a derivation of the Green's function for the 1D Helmholtz equation, and follow that by using it to find the Green's function for the 1D Laplacian.  Then, we will confront the demonic Bessel functions required for the 2D Helmholtz operator Green's function, and it's Laplacian Green's function limit.  Finally, for completeness sake, we will finish with our own derivation of the 3D result.

\section{Motivation and context.}
We seek a solution to non-homogeneous Helmholtz equation
\begin{equation}\label{eqn:helmholtzGreens:20}
\lr{ \spacegrad^2 + k^2 } U(\Bx) = V(\Bx).
\end{equation}

This is a problem that can be solved using Fourier transform techniques.  Let's write our transform pair in the symmetrical form:
\begin{equation}\label{eqn:helmholtzGreens:40}
\begin{aligned}
F(x) &= \frac{1}{\sqrt{2 \pi}} \int \hat{F}(p) e^{j p x} dp \\
\hat{F}(p) &= \frac{1}{\sqrt{2 \pi}} \int F(x) e^{-j p x} dx.
\end{aligned}
\end{equation}

Expressing \(U(\Bx), V(\Bx)\), in terms of their Fourier transforms, \cref{eqn:helmholtzGreens:20} becomes
\begin{equation}\label{eqn:helmholtzGreens:80}
\begin{aligned}
0 &=
\lr{ \spacegrad^2 + k^2 }
\lr{\inv{\sqrt{2 \pi}}}^N
\int \hat{U}(\Bp) e^{j \Bp \cdot \Bx} d\Bp
-
\lr{\inv{\sqrt{2 \pi}}}^N
\int \hat{V}(\Bp) e^{j \Bp \cdot \Bx} d\Bp \\
&=
\lr{\inv{\sqrt{2 \pi}}}^N
\int \lr{ \hat{U}(\Bp) \lr{ -\Bp^2 + k^2 } - \hat{V}(\Bp) } e^{j \Bp \cdot \Bx} d\Bp,
\end{aligned}
\end{equation}
which requires
\begin{equation}\label{eqn:helmholtzGreens:100}
\hat{U}(\Bp) = \frac{\hat{V}(\Bp) }{k^2 - \Bp^2}.
\end{equation}

We can now inverse transform to find \( U(\Bx) \), which gives
\begin{equation}\label{eqn:helmholtzGreens:120}
\begin{aligned}
U(\Bx) &=
\lr{\inv{\sqrt{2 \pi}}}^N \int \hat{U}(\Bp) e^{j \Bp \cdot \Bx} d\Bp \\
&=
\lr{\inv{\sqrt{2 \pi}}}^N \int
\frac{\hat{V}(\Bp) }{k^2 - \Bp^2} e^{j \Bp \cdot \Bx} d\Bp \\
&=
\lr{\inv{2 \pi}}^N \int
\inv{k^2 - \Bp^2} e^{j \Bp \cdot \Bx} d\Bp \int V(\Bx') e^{-j \Bp \cdot \Bx'} d\Bx' \\
&=
\int V(\Bx') d\Bx'
\lr{\inv{2 \pi}}^N
\int
\inv{k^2 - \Bp^2} e^{j \Bp \cdot \lr{\Bx - \Bx'}}
d\Bp
.
\end{aligned}
\end{equation}

The general solution is given by
\begin{equation}\label{eqn:helmholtzGreens:140}
U(\Bx) = \int G(\Bx, \Bx') V(\Bx') d\Bx',
\end{equation}
where \( G(\Bx, \Bx') \) is called the Green's function, and has the form
\begin{equation}\label{eqn:helmholtzGreens:160}
G(\Bx, \Bx') = \lr{\inv{2 \pi}}^N
\int
\inv{k^2 - \Bp^2} e^{j \Bp \cdot \lr{\Bx - \Bx'}}
d\Bp.
\end{equation}

Equivalently, if we presume that a solution of the form \cref{eqn:helmholtzGreens:140} can be found, and operate on that with the Helmholtz operator \( \spacegrad^2 + k^2 \), we find
\begin{equation}\label{eqn:helmholtzGreens:60}
\lr{ \spacegrad^2 + k^2 } U(\Bx) = \int \lr{ \spacegrad^2 + k^2 } G(\Bx, \Bx') V(\Bx') d\Bx' = V(\Bx),
\end{equation}
which requires that our Green's function \( G(\Bx, \Bx') \) has the functional form
\begin{equation}\label{eqn:helmholtzGreens:180}
\lr{ \spacegrad^2 + k^2 } G(\Bx, \Bx') = \delta(\Bx - \Bx').
\end{equation}
If we can find a function, \( G(\Bx, \Bx') \), by any means, that has this delta function behaviour, then we solve the problem.

\section{Helmholtz Green's function in 1D.}
\subsection{Evaluating the integral.}
For the one dimensional case, we want to evaluate
\begin{equation}\label{eqn:helmholtzGreens:200}
G(r) = -\inv{2 \pi} \int \inv{p^2 - k^2} e^{j p r} dp,
\end{equation}
an integral which is unfortunately non-convergent.  Since we are dealing with delta functions, it is not surprising that we have convergence problems.  The technique used in the book is to displace the pole slightly by a small imaginary amount, and then take the limit.

That is
\begin{equation}\label{eqn:helmholtzGreens:220}
G(r) = \lim_{\epsilon \rightarrow 0} G_\epsilon(r),
\end{equation}
where
\begin{equation}\label{eqn:helmholtzGreens:240}
\begin{aligned}
G_\epsilon(r)
&= -\inv{2 \pi} \int_{-\infty}^\infty \inv{p^2 - \lr{k + j \epsilon}^2} e^{j p r} dp \\
&= -\inv{2 \pi} \int_{-\infty}^\infty \frac{e^{j p r}}{\lr{ p - k -j \epsilon}\lr{p + k + j \epsilon}} dp.
\end{aligned}
\end{equation}
Our contours, for \( \epsilon > 0 \), are illustrated in \cref{fig:greensHelmholtz:greensHelmholtzFig1ab}.
\imageTwoFigures{../figures/blogit/greensHelmholtzFig1a}{../figures/blogit/greensHelmholtzFig2}{Contours for 3D Green's function evaluation}{fig:greensHelmholtz:greensHelmholtzFig1ab}{scale=0.7}
For \( r > 0 \) we can use an upper half plane infinite semicircular contour integral, since Jordan's lemma tells us that the integral over the semicircular contour tends to zero as \( R \rightarrow \infty \) .
%\imageFigure{../figures/blogit/greensHelmholtzFig1a}{Contour for \( r > 0 \).}{fig:greensHelmholtz:greensHelmholtzFig1a}{0.2}
The residue calculation for this contour gives
\begin{equation}\label{eqn:helmholtzGreens:260}
\begin{aligned}
G_\epsilon(r)
&= -\frac{(+2 \pi j)}{2 \pi} \evalbar{\frac{e^{j p r}}{p + k + j \epsilon} }{p = k + j \epsilon} \\
&= -j \frac{e^{j \lr{k + j \epsilon} r}}{2\lr{k + j \epsilon}} \\
&= -j \frac{e^{j k r} e^{-\epsilon r}}{2\lr{k + j \epsilon}} \\
&\rightarrow -\frac{j}{2k} e^{j k r}.
\end{aligned}
\end{equation}

For \( r < 0 \) we use the lower half plane infinite semicircular contour
%\imageFigure{../figures/blogit/greensHelmholtzFig2}{Contour for \( r < 0 \).}{fig:greensHelmholtz:greensHelmholtzFig2}{0.3}
For this contour, we find
\begin{equation}\label{eqn:helmholtzGreens:280}
\begin{aligned}
G_\epsilon(r)
&= -\frac{2 \pi j}{(-2 \pi)} \evalbar{\frac{e^{j p r}}{p - k - j \epsilon} }{p = -k - j \epsilon} \\
&= -j \frac{e^{-j \lr{k + j \epsilon} r}}{2\lr{k + j \epsilon}} \\
&= -j \frac{e^{-j k r} e^{\epsilon r}}{2\lr{k + j \epsilon}} \\
&\rightarrow -\frac{j}{2k} e^{-j k r}.
%\\
%&= -\frac{j}{2k} e^{j k \Abs{r}}.
\end{aligned}
\end{equation}
Combining both results, our Green's function, after a positive pole displacement \( \epsilon > 0 \), is
\begin{equation}\label{eqn:helmholtzGreens:300}
G(r) = \frac{1}{2 j k} e^{j k \Abs{r}}.
\end{equation}

Similarly, should we pick \( \epsilon < 0 \), the same sort of calculation yields an incoming wave solution
\begin{equation}\label{eqn:helmholtzGreens:2240}
G(r) = -\frac{1}{2 j k} e^{-j k \Abs{r}}.
\end{equation}

Allowing for either, we have Green's functions for both the incoming and outgoing wave cases
\begin{equation}\label{eqn:helmholtzGreens:2260}
\boxed{
G_{\pm}(x - x') = \pm \frac{1}{2 j k} e^{ \pm j k \Abs{x - x'}}.
}
\end{equation}

With two Green's functions, we can also make a linear combination.  Specifically
\begin{equation}\label{eqn:helmholtzGreens:2280}
\begin{aligned}
G(r)
&= \inv{2}\lr{ G_{+}(r) + G_{-}(r) } \\
&= \inv{4 j k}\lr{ e^{ j k \Abs{r}} - e^{ - j k \Abs{r}} } \\
&= \inv{2 k} \sin\lr{ k \Abs{r} }
\end{aligned}
\end{equation}
This real valued Green's function is plotted in \cref{fig:plotOfOneDimG:plotOfOneDimGFig8}.
\imageFigure{../figures/blogit/plotOfOneDimGFig8}{Green's function for 1D Helmholtz operator.}{fig:plotOfOneDimG:plotOfOneDimGFig8}{0.3}

The convolution is now fully specified, providing a specific solution to the non-homogeneous equation
\begin{equation}\label{eqn:helmholtzGreens:400}
U(x) = \inv{2k} \int_{-\infty}^\infty \sin( k\Abs{r} ) V(x + r) dr.
\end{equation}
The general solution may also include any solutions to the homogeneous Helmholtz equation
\begin{equation}\label{eqn:helmholtzGreens:2300}
U(x) = A e^{j k x} + B e^{-j k x} + \inv{2k} \int_{-\infty}^\infty \sin( k\Abs{r} ) V(x + r) dr.
\end{equation}

\subsubsection{A strictly causal solution.}
We can split the convolution kernel a ``causal'' part, where only the spatially-``past'' values of \( V \) contribute, and an ``acausal'' part
\begin{equation}\label{eqn:helmholtzGreens:2320}
U(x) =
\inv{2k} \int_{-\infty}^0 \sin( k\Abs{r} ) V(x + r) dr
+
\inv{2k} \int_{0}^\infty \sin( k\Abs{r} ) V(x + r) dr.
\end{equation}
In a sense, we are averaging causal and acausal portions of the convolution.

Suppose that we form a convolution with a built in cut-off, so that values of \( V(x'), x' > x \) do not contribute to \( U(x) \).  That is
\begin{equation}\label{eqn:helmholtzGreens:440}
f(x) = \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'.
\end{equation}
Here the one-half factor has been dropped, since we are no longer performing a QFT like average of causal and acausal terms.

Intuition suggests this should be a solution to the Helmholtz equation, but let's test that guess.  We start with the identity
\begin{equation}\label{eqn:helmholtzGreens:460}
\frac{d}{dx} \int_a^x g(x, x') dx'
=
\evalbar{g(x, x') }{x' = x} + \int_a^x \frac{\partial g(x,x')}{dx} dx'.
\end{equation}
Taking the first derivative of \( f(x) \), we find
\begin{equation}\label{eqn:helmholtzGreens:480}
\begin{aligned}
\frac{df}{dx}
&= \evalbar{ \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') }{x' = x} + k \int_{-\infty}^x \frac{\cos\lr{k \lr{x - x'}}}{k} V(x') dx' \\
&= k \int_{-\infty}^x \frac{\cos\lr{k \lr{x - x'}}}{k} V(x') dx',
\end{aligned}
\end{equation}
where we have, somewhat lazily, treated the infinite limit as a constant.  Effectively, this requires that the forcing function \( V(x) \) is zero at \( -\infty \).  Taking the second derivative, we have
\begin{equation}\label{eqn:helmholtzGreens:500}
\begin{aligned}
\frac{d^2f}{dx^2}
&=
\evalbar{ k \frac{\cos\lr{k \lr{x - x'}}}{k} V(x') }{x' = x} - k^2 \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx' \\
&= V(x) - k^2 f(x),
\end{aligned}
\end{equation}
or
\begin{equation}\label{eqn:helmholtzGreens:520}
\frac{d^2}{dx^2} f(x) + k^2 f(x) = V(x).
\end{equation}
This verifies that \cref{eqn:helmholtzGreens:440} is also a specific solution to the wave equation, as expected and desired.

It appears that the general solution is likely of the following form
\begin{equation}\label{eqn:helmholtzGreens:380b}
U(x) =
A' \cos\lr{ k x } +
B' \sin\lr{ k x }
+\alpha \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'
+(1-\alpha)\int_x^\infty \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx',
\end{equation}
with \( \alpha \in [0,1] \).

It's pretty cool that we can completely solve the 1D forced wave equation, for any forcing function, from first principles.  Yes, I took liberties that would make a mathematician cringe, but we are telling a story, and leaving the footnotes to somebody else.

%\subsubsection{More specific boundary constraints.}
%Just as we have the freedom to add any homogeneous solution to our specific convolution based solution, we may do so for the Green's function itself.  Our process above, implicitly assumes that we are interested in infinite boundary value constraints.  Should we wish to impose different boundary constraints, we can form
%\begin{equation}\label{eqn:helmholtzGreens:420}
%G(r) = A e^{ j k r} + B e^{-j k r} - \frac{j \sgn(r)}{2k} e^{j k \Abs{r}},
%\end{equation}
%but must then use the boundary value constraints to determine the desired form of the Green's function, using the two degrees of freedom to do so.  That's also an interesting topic, and would be good to also visit in a followup post.

\subsection{Verification of the 1D Helmholtz Green's function.}

Let's show that the outgoing Green's function has the desired delta function semantics.  That is
\begin{equation}\label{eqn:helmholtzGreens:2060}
\lr{ \spacegrad^2 + k^2 } G(x, x') = \delta(x - x'),
\end{equation}
where
\begin{equation}\label{eqn:helmholtzGreens:2080}
G(x, x') = \frac{e^{j k \Abs{x - x'}}}{2 j k}.
\end{equation}
Making a \( r = x - x' \) change of variables gives
\begin{equation}\label{eqn:helmholtzGreens:2120}
\spacegrad^2 e^{j k \Abs{x - x'}} = \frac{d^2}{dr^2} e^{j k \Abs{r}}
\end{equation}

The function \( \Abs{r} \) formally has no derivative at the origin, but we may use the physics trick, rewriting the absolute in terms of the Heaviside theta function
\begin{equation}\label{eqn:helmholtzGreens:2340}
\Abs{r} = r \Theta(r) - r \Theta(-r).
\end{equation}
We then use the delta function identification for the derivative
\begin{equation}\label{eqn:helmholtzGreens:2360}
\Theta'(r) = \delta(r).
\end{equation}
In particular
\begin{equation}\label{eqn:helmholtzGreens:2380}
\begin{aligned}
\frac{d}{dr} \Abs{r}
&= \Theta(r) - \Theta(-r) + r \delta(r) - (-1)\delta(-r) \\
&= \Theta(r) - \Theta(-r) + 2 r \delta(r),
\end{aligned}
\end{equation}
using the symmetric property of the delta function \( \delta(-r) = \delta(r) \).  The delta function contribution to this derivative is actually zero, as seen when we operate with \( r \delta(r) \) against a test function
\begin{equation}\label{eqn:helmholtzGreens:2400}
\begin{aligned}
\int r \delta(r) f(r) dr
&=
\evalbar{r f(r)}{r = 0} \\
&= 0.
\end{aligned}
\end{equation}
We've now found that
\begin{equation}\label{eqn:helmholtzGreens:2420}
\frac{d}{dr} \Abs{r} =  \Theta(r) - \Theta(-r) = \sgn(r),
\end{equation}
the sign function.  The derivative of the sign function is
\begin{equation}\label{eqn:helmholtzGreens:2440}
\begin{aligned}
\sgn'(r)
&= \lr{  \Theta(r) - \Theta(-r) }' \\
&= \delta(r) -(-1)\delta(-r) \\
&= 2 \delta(r).
\end{aligned}
\end{equation}

The derivatives are
\begin{equation}\label{eqn:helmholtzGreens:2140}
\begin{aligned}
\frac{d}{dr} e^{j k \Abs{r} }
&=
j k e^{j k \Abs{r} } \frac{d\Abs{r}}{dr} \\
&=
j k e^{j k \Abs{r} } \sgn(r).
\end{aligned}
\end{equation}
and
\begin{equation}\label{eqn:helmholtzGreens:2160}
\frac{d^2}{dr^2} e^{j k \Abs{r}}
=
\lr{ j k \sgn(r) }^2 e^{j k \Abs{r} } + 2 j k e^{j k \Abs{r} } \delta(r).
\end{equation}

We can identify \( e^{j k \Abs{r} } \delta(r) = \delta(r) \), just as we identified \( r \delta(r) = 0 \), by application to a test function.  That is
\begin{equation}\label{eqn:helmholtzGreens:2180}
\begin{aligned}
\int e^{j k \Abs{r} } \delta(r) f(r) dr
&=
\evalbar{e^{j k \Abs{r} } f(r)}{r = 0} \\
&=
f(0) \\
&=
\int \delta(r) f(r) dr.
\end{aligned}
\end{equation}
With that identification
\begin{equation}\label{eqn:helmholtzGreens:2200}
\spacegrad^2 e^{j k \Abs{r} } = -k^2 e^{j k \Abs{r} } + 2 j k \delta(r),
\end{equation}
or
\begin{equation}\label{eqn:helmholtzGreens:2220}
\boxed{
\lr{ \spacegrad^2 + k^2 } \frac{e^{j k \Abs{x - x'} }}{2 j k} = \delta(x - x').
}
\end{equation}

\subsection{Verifying the Green's function with convolution.}
Avoiding the physics tricks, we may use a limiting argument to validate our Green's function.

We first want to show that at points \( x' \ne x \) the Helmholtz operator applied to the Green's function is zero:
\begin{equation}\label{eqn:helmholtzGreens:1220}
\lr{ \spacegrad^2 + k^2} G(x,x') = 0,
\end{equation}
Since we are avoiding the origin
\begin{equation}\label{eqn:helmholtzGreens:1240}
\lr{ k^2 + \frac{d^2}{dx^2} } e^{j k \Abs{x - x'}}.
\end{equation}
We expect that this will be zero.  Making a change of variables \( r = x' - x \), we want to evaluate
\begin{equation}\label{eqn:helmholtzGreens:1260}
\lr{ k^2 + \frac{d^2}{dr^2} } e^{j k \Abs{r}},
\end{equation}
assuming that we are omitting a neighbourhood around \( r = 0 \) where the absolute value causes trouble.  For \( r > 0 \)
\begin{equation}\label{eqn:helmholtzGreens:1280}
\begin{aligned}
\frac{d}{dr} e^{j k \Abs{r}}
&= \frac{d}{dr} e^{j k r} \\
&= j k e^{j k r},
\end{aligned}
\end{equation}
and
\begin{equation}\label{eqn:helmholtzGreens:1300}
\begin{aligned}
\frac{d^2}{dr^2} e^{j k \Abs{r}}
&= \frac{d}{dr} j k e^{j k r} \\
&= (j k)^2 e^{j k r}.
\end{aligned}
\end{equation}
Similarly, for \( r < 0 \), we have
\begin{equation}\label{eqn:helmholtzGreens:1320}
\frac{d^2}{dr^2} e^{j k \Abs{r}} = (-jk)^2 e^{j k \Abs{r}}.
\end{equation}
In both cases, provided we are in a neighbourhood that omits \( r \ne 0 \), we have
\begin{equation}\label{eqn:helmholtzGreens:1340}
\lr{ k^2 + \frac{d^2}{dr^2} } e^{j k \Abs{r}} = 0,
\end{equation}
as desired.

The takeaway is that we have
\begin{equation}\label{eqn:helmholtzGreens:1360}
\begin{aligned}
\lr{ \spacegrad^2 + k^2 }\int_{-\infty}^\infty G(x, x') V(x') dx'
&=
\int_{\Abs{x' - x} \le \epsilon} V(x') \lr{ \frac{d^2}{d{x'}^2} + k^2 } G(x, x') dx' \\
&=
\int_{-\epsilon}^\epsilon V(x + r) \lr{ \frac{d^2}{dr^2} + k^2 } G(r) dr \\
\end{aligned}
\end{equation}
for some arbitrarily small value of \( \epsilon \).  Observe that after bringing the operator into the integral, we also made a change of variables, first to \( x' \) for the Laplacian, and then to \( r = x' - x \).

We'd like the 1D equivalent of Green's theorem to reduce this, so let's work that out first.
\begin{equation}\label{eqn:helmholtzGreens:1380}
\begin{aligned}
\int dx\, v \frac{d^2 u}{dx^2} - \int dx\, u \frac{d^2 v}{dx^2}
&=
\int dx\,
\lr{
    \frac{d}{dx} \lr{
        v \frac{du}{dx}
    }
- \frac{dv}{dx} \frac{du}{dx}
}
-
\int dx\,
\lr{
    \frac{d}{dx} \lr{
        u \frac{dv}{dx}
    }
    -
    \frac{du}{dx} \frac{dv}{dx}
}
\\
&=
\int dx\,
    \frac{d}{dx}
    \lr{
        v \frac{du}{dx}
    }
-
\int dx\,
    \frac{d}{dx} \lr{
        u \frac{dv}{dx}
    }
\\
&=
v \frac{du}{dx}
-
u \frac{dv}{dx},
\end{aligned}
\end{equation}
so
\begin{equation}\label{eqn:helmholtzGreens:1400}
\boxed{
    \int_a^b dx\, v \frac{d^2 u}{dx^2}
    =
    \int_a^b dx\, u \frac{d^2 v}{dx^2}
    +
    \evalrange{v \frac{du}{dx}}{a}{b}
    -
    \evalrange{u \frac{dv}{dx}}{a}{b}.
}
\end{equation}

This gives us
\begin{equation}\label{eqn:helmholtzGreens:1420}
\begin{aligned}
\lr{ \spacegrad^2 + k^2 }\int_{\Abs{x'- x} \le \epsilon} e^{j k \Abs{x - x'}} V(x') dx'
&=
\int_{-\epsilon}^\epsilon e^{j k \Abs{r}} \lr{ k^2 + \frac{d^2}{dr^2} } V(x + r) dr \\
&\quad +
\evalrange{ V(x + r) \frac{d}{dr} e^{j k \Abs{r}} }{-\epsilon}{\epsilon}
-
\evalrange{ e^{j k \Abs{r}} \frac{d}{dr} V(x+r) }{-\epsilon}{\epsilon}.
\end{aligned}
\end{equation}
If we can assume that \( V \) and it's first and second derivatives are all continuous over this small interval, then the first integral is approximately
\begin{equation}\label{eqn:helmholtzGreens:1440}
\begin{aligned}
\int_{-\epsilon}^\epsilon e^{j k \Abs{r}} \lr{ k^2 + \frac{d^2}{dr^2} } V(x + r) dr
&\sim
\lr{ \lr{ k^2 + \frac{d^2}{dr^2} } V(x + r) }
\int_{-\epsilon}^\epsilon e^{j k \Abs{r}} dr \\
&=
\frac{2 j}{k} \lr{ 1 - e^{ j k \epsilon} }
\lr{ \lr{ k^2 + \frac{d^2}{dr^2} } V(x + r) } \\
&\rightarrow 0.
\end{aligned}
\end{equation}
Similarly, with \( dV/dr \) continuity condition, that last term is also zero.  We are left, for \( \epsilon \) sufficiently small, we are left with
\begin{equation}\label{eqn:helmholtzGreens:1460}
\lr{ \spacegrad^2 + k^2 }\int_{\Abs{x'- x} \le \epsilon} e^{j k \Abs{x - x'}} V(x') dx'
=
V(x)
\evalrange{ \frac{d}{dr} e^{j k \Abs{r}} }{-\epsilon}{\epsilon}.
\end{equation}
Because we are evaluating this derivative only at points \( r = \pm \epsilon \ne 0 \), that derivative is
\begin{equation}\label{eqn:helmholtzGreens:2460}
\frac{d}{dr} e^{j k \Abs{r}}
=
j k e^{j k \Abs{r}} \sgn(r),
\end{equation}
leaving us with
\begin{equation}\label{eqn:helmholtzGreens:2480}
\begin{aligned}
\evalrange{ \frac{d}{dr} e^{j k \Abs{r}} }{-\epsilon}{\epsilon}
&=
j k e^{j k \Abs{\epsilon}} \sgn(\epsilon) - j k e^{j k \Abs{-\epsilon}} \sgn(-\epsilon) \\
&=
j k e^{j k \Abs{\epsilon}} \lr{ 1 - (-1) } \\
2 j k e^{j k \Abs{\epsilon}}.
\end{aligned}
\end{equation}
or
\begin{equation}\label{eqn:helmholtzGreens:2500}
\lr{ \spacegrad^2 + k^2 }\int_{-\infty}^\infty e^{j k \Abs{x - x'} } V(x') dx'
=
2 j k e^{j k \Abs{\epsilon}} V(x).
\end{equation}
Taking limits and dividing through by \( 2 j k \) proves the result.

\section{1D Laplacian Green's function.}
Let's further validate the Helmholtz Green's function by deriving the Green's function for the 1D Laplacian.  We should also be able to verify that it has the correct delta function semantics.

\subsection{Expansion in series and taking the limit.}
The easiest way to take this limit is to expand the sine form of the Green's function around \( k = 0 \)
\begin{equation}\label{eqn:helmholtzGreens:2540}
\begin{aligned}
\frac{\sin\lr{ k \Abs{r} } }{2k}
&= \inv{2k} \lr{ k \Abs{r} + O((k \Abs{r})^3) } \\
&= \frac{\Abs{r}}{2} +  O(k^2),
\end{aligned}
\end{equation}
so, in the \( k \rightarrow 0 \) limit, the Laplacian Green's function is
\begin{equation}\label{eqn:helmholtzGreens:1820}
\boxed{
G(r) = \frac{\Abs{r}}{2}.
}
\end{equation}

An interesting aside.  We ought to be able to also find the Laplacian limit using the exponential form of the Helmholtz Green's function as a starting point, but it's not at all obvious how that works.  Here is the trick, first expanding the Green's function in series about \( k \Abs{r} \) as above.
\begin{equation}\label{eqn:helmholtzGreens:1780}
\begin{aligned}
G(r)
&= -\frac{j}{2k} \lr{ 1 + j k \Abs{r} + O((k \Abs{r})^2) } \\
&= -\frac{j}{2} \lr{ \inv{k} + j \Abs{r} + \inv{k} O((k \Abs{r})^2) } \\
\end{aligned}
\end{equation}
This means that to first order in \( k \), we have
\begin{equation}\label{eqn:helmholtzGreens:1800}
G(r) + \frac{j}{2k} = \frac{\Abs{r}}{2}.
\end{equation}
The trick to taking this limit is to note that we are free to add constant terms to the Green's function for the Laplacian, and then discard the \( 1/k \) term before taking the limit, treating \( k \) as a constant.

\subsection{Verifying the Green's function.}
Observe that
\begin{equation}\label{eqn:helmholtzGreens:2520}
\frac{d^2}{dr^2} \frac{\Abs{r}}{2} =
\frac{d}{dr} \frac{\sgn(r)}{2} =
\delta(r),
\end{equation}
which verifies that this is a valid Green's function for the 1D Laplacian.

\subsection{Verifying the Green's function with convolution.}
We can also operate on the convolution with the Laplacian, to verify correctness.  We are interested in evaluating
\begin{equation}\label{eqn:helmholtzGreens:1840}
\spacegrad^2 \int \frac{\Abs{x - x'}}{2} V(x') dx' = \int V(x + r) \frac{d^2}{dr^2} \frac{\Abs{r}}{2} dr.
\end{equation}
If all goes well, this should evaluate to \( V(x) \), indicating that \( \spacegrad^2 \Abs{x - x'}/2 = \delta(x - x') \).  As a first step, we expect \( \spacegrad^2 G = 0 \), for \( x \ne x' \).  Consider first \( r > 0 \), where
\begin{equation}\label{eqn:helmholtzGreens:1860}
\frac{d}{dr} \Abs{r}
=
\frac{d}{dr} r
= 1,
\end{equation}
and for \( r < 0 \) where
\begin{equation}\label{eqn:helmholtzGreens:1880}
\frac{d}{dr} \Abs{r}
=
\frac{d}{dr} (-r)
= -1.
\end{equation}
This means that, away from the origin \( d\Abs{r}/dr = \sgn(r) \), and \( d^2 \Abs{r}/dr^2 = 0\).  We can conclude that, for some non-zero positive epsilon that we will eventually let approach zero, we have
\begin{equation}\label{eqn:helmholtzGreens:1900}
\begin{aligned}
\spacegrad^2 \int \frac{\Abs{x - x'}}{2} V(x') dx'
&= \int_{-\epsilon}^\epsilon V(x + r) \frac{d^2}{dr^2} \frac{\Abs{r}}{2} dr \\
&= \int_{-\epsilon}^\epsilon \lr{
    \frac{d}{dr} \lr{ V(x + r) \frac{d}{dr} \frac{\Abs{r}}{2} }
    - \frac{dV(x + r)}{dr} \frac{d}{dr} \frac{\Abs{r}}{2}
}
dr \\
&=
\evalrange{ V(x + r) \frac{d}{dr} \frac{\Abs{r}}{2} }{-\epsilon}{\epsilon}
- \int_{-\epsilon}^\epsilon
\lr{
\frac{d}{dr} \lr{ \frac{dV(x + r)}{dr} \frac{\Abs{r}}{2} }
-
\frac{d^2V(x + r)}{dr^2} \frac{\Abs{r}}{2}
} dr \\
&=
\evalrange{ V(x + r) \frac{d}{dr} \frac{\Abs{r}}{2} }{-\epsilon}{\epsilon}
-\evalrange{ \frac{dV(x + r)}{dr} \frac{\Abs{r}}{2} }{-\epsilon}{\epsilon}
+
\int_{-\epsilon}^\epsilon \frac{d^2V(x + r)}{dr^2} \frac{\Abs{r}}{2} dr \\
&=
\inv{2} \lr{ V(x + \epsilon) + V(x - \epsilon) } \\
&-\quad \frac{\epsilon}{2}\lr{
    \frac{dV(x + \epsilon)}{dr}
    -
    \frac{dV(x - \epsilon)}{dr}
} \\
&+
\frac{\epsilon^2}{2} \lr{
    \frac{d^2V(x + \epsilon)}{dr^2}
    +
    \frac{d^2V(x + \epsilon)}{dr^2}
}.
\end{aligned}
\end{equation}
In the limit we have
\begin{equation}\label{eqn:helmholtzGreens:1920}
\boxed{
\spacegrad^2 \int G(x, x') V(x') dx' = \inv{2} \lr{ V(x^+) + V(x^-) }.
}
\end{equation}

If the test (or driving) function is continuous at \( x' = x \), then this is exactly the delta-function semantics that we expect of a Green's function.  It's interesting that this check provides us with precise semantics for the Green's function for discontinuous functions too.
\section{2D Green's function.}
\subsection{Evaluating the integral.}
Okay, now let's do the 2D Green's function evaluation.  Our starting place is
\begin{equation}\label{eqn:helmholtzGreens:680}
G(\Br) = -\inv{(2 \pi)^2} \int \frac{e^{j \Bp \cdot \Br}}{\Bp^2 - k^2} d^2 p.
\end{equation}
With a change of variables to polar coordinates, letting
\begin{equation}\label{eqn:helmholtzGreens:700}
\begin{aligned}
\Bp &= p \lr{ \cos\phi, \sin\phi } \\
\Br &= \Abs{\Br} \Be_2,
\end{aligned}
\end{equation}
we can make the integral explicit
\begin{equation}\label{eqn:helmholtzGreens:720}
G(\Br) = -\inv{(2 \pi)^2} \int_0^\infty \frac{p dp}{p^2 - k^2} \int_0^{2 \pi} d\phi e^{j p \Abs{\Br} \sin\phi}.
\end{equation}
Unlike the 3D case, where the angular dependence could be trivially evaluated, we are no longer so lucky.  What on earth can we do with the \( \phi \) integral?  Just like Hilter's lament about ``undoable integrals in Jackson'' \citep{hilterLearnsJackson}, we are faced with the same enemy.  As it turns out, due to the cylindrical symmetry of the problem, we are also staring down the gun of Bessel functions.  Both Mathematica and Grok point out that we can evaluate integrals of this form, like so:
\begin{equation}\label{eqn:helmholtzGreens:740}
\int_0^{2 \pi} d\phi e^{j a \sin\phi} = 2 \pi J_0(a).
\end{equation}

From \citep{byron1992mca} we have two representations of \( J_n \), a series representation and integral representation
\begin{equation}\label{eqn:helmholtzGreens:760}
J_n(z) = \sum_{m=0}^\infty \frac{(-1)^m (z/2)^{2m + n}}{(n + m)!m!} = \inv{\pi} \int_0^\pi \cos(n \theta - z \sin\theta) d\theta.
\end{equation}

In particular, this means that
\begin{equation}\label{eqn:helmholtzGreens:800}
J_0(z) = \sum_{m=0}^\infty \frac{(-1)^m (z/2)^{2m}}{(m!)^2} = J_0(z) = \inv{\pi} \int_0^\pi \cos(z \sin\theta) d\theta.
\end{equation}
This is a damped sine like function, as illustrated in \cref{fig:j0:j0Fig4}.
\imageFigure{../figures/blogit/j0Fig4}{Bessel function of zeroth order.}{fig:j0:j0Fig4}{0.3}

In \S 6.9, both of these are derived from a generating function representation of the Bessel functions, and one of the intermediate steps in that construction has
\begin{equation}\label{eqn:helmholtzGreens:840}
J_n(z) = \inv{2\pi} \int_{-\pi}^\pi e^{-j(n\theta - z \sin\theta)} d\theta,
\end{equation}
where the \( [-\pi, \pi] \) range was the result of a contour integration using a unit circle parameterization, which could have also used \( [0, 2 \pi] \).  That means, sure enough, that we have
\begin{equation}\label{eqn:helmholtzGreens:860}
J_0(z) = \inv{2\pi} \int_{0}^{2\pi} e^{j z \sin\theta} d\theta,
\end{equation}
as claimed by both Grok and Mathematica.

This means that the evaluation of the Green's function is now reduced to the limit of one final integral
\begin{equation}\label{eqn:helmholtzGreens:880}
G(\Br) = -\inv{2 \pi} \int_0^\infty \frac{p J_0(p \Abs{\Br} ) dp}{p^2 - \lr{k + j \epsilon}^2},
\end{equation}
where we've also displaced the problematic pole by a small imaginary amount as before.  Grok incorrectly claimed that this was an even integral, and then argued that the end result is a Hankel function (that may be the case, but it's reasoning to get there was clearly wrong.) Mathematica, on the other hand, can evaluate this integral, as shown in \cref{fig:HelmholtzGreens2DMathematica:HelmholtzGreens2DMathematicaFig9}.

\imageFigure{../figures/blogit/HelmholtzGreens2DMathematicaFig9}{Mathematica evaluation of the 2D Green's function}{fig:HelmholtzGreens2DMathematica:HelmholtzGreens2DMathematicaFig9}{0.4}
% helmholtzGreens2D.nb

%\begin{equation}\label{eqn:helmholtzGreens:900}
%G(\Br) = -\inv{2 \pi} K_0\lr{\frac{\Abs{\Br}}{\sqrt{\frac{1}{(\epsilon - j k)^2}}}}, \epsilon \neq 0.
%\end{equation}
%It's not clear to me why Mathematica writes the argument as 1 over a reciprocal root.  Perhaps that has something to do with the branch cut that Mathematica uses for it's square root function?  If I plug in representative numeric values, it simplifies in the expected way, as illustrated in \cref{fig:MathematicaWeirdArgument:MathematicaWeirdArgumentFig5}.
%\imageFigure{../figures/blogit/MathematicaWeirdArgumentFig5}{Mathematica weird Bessel argument.}{fig:MathematicaWeirdArgument:MathematicaWeirdArgumentFig5}{0.1}

The limiting form of the 2D Green's function, is
\begin{equation}\label{eqn:helmholtzGreens:920}
G(\Bx, \Bx') = -\inv{2 \pi} K_0\lr{\mp j k \Abs{\Bx - \Bx'} },
\end{equation}
with the negative sign coming from the \( \epsilon > 0 \) case, and positive for \( \epsilon < 0 \).
A peek at \citep{abramowitz1964handbook} shows that \( K_0 \) can be expressed in terms of a Hankel function of the first kind (order 0) \( H_0^{(1)}(z) = J_0(z) + j Y_0(z) \), plotted in \cref{fig:hankelPlot:hankelPlotFig6}.
\imageFigure{../figures/blogit/hankelPlotFig6}{Hankel function of the first kind (order 0).}{fig:hankelPlot:hankelPlotFig6}{0.3}

For real positive \( \alpha \), we have
\begin{equation}\label{eqn:helmholtzGreens:940}
K_0(-j \alpha) = \frac{j\pi}{2} H_0^{(1)}(\alpha),
\end{equation}
so
\begin{equation}\label{eqn:helmholtzGreens:960}
\boxed{
G(\Bx, \Bx') = -\frac{j}{4} H_0^{(1)}(\pm k \Abs{\Bx - \Bx'}).
}
\end{equation}

\section{The 2D Laplacian Green's function.}
Like the exponential form of the 1D Helmholtz Green's function, the 2D Green's function has the appearance of being malformed for \( k \rightarrow 0 \).

\subsection{An asymptotic expansion of The 2D Helmholtz Green's function.}
Let's try to carefully expand the Helmholtz 2D Green's function in the neighbourhood of \( k = 0 \), which will provide us with the Green's function for the 2D Laplacian.

In \citep{abramowitz1964handbook}, \S 9.1.7, 9.1.8, we have for \( z \rightarrow 0 \)
\begin{equation}\label{eqn:helmholtzGreens:980}
\begin{aligned}
J_\nu(z) &\sim \lr{\frac{z}{2}}^\nu/\Gamma(\nu+1) \\
Y_0(z) &\sim \frac{2}{\pi} \ln z,
\end{aligned}
\end{equation}
so for \( k \ll r \)
\begin{equation}\label{eqn:helmholtzGreens:1000}
H_0^{(1)}(k r) \sim 1 + \frac{2j}{\pi} \ln\lr{k r},
\end{equation}
and
\begin{equation}\label{eqn:helmholtzGreens:1020}
\begin{aligned}
G(\Br)
&\sim -\frac{j}{4} \lr{ 1 + \frac{j}{2 \pi} \ln\lr{k r} } \\
&= -\frac{j}{4} + \frac{1}{2 \pi} \ln k + \frac{1}{2 \pi} \ln r.
\end{aligned}
\end{equation}
Here is where we have to get sneaky.  Since we seek a Green's function for the Laplacian operator, we are free to add any solution \( f(x,y) \) that satisfies \( \spacegrad^2 f = 0 \).  Constants are clearly in that homogeneous solution space, so we may adjust this expansion of the Green's function, throwing away the leading constant imaginary term, and treating \( k \) as a small constant, the \( \ln k \) term.  That leaves us with
\begin{equation}\label{eqn:helmholtzGreens:1040}\boxed{
G(\Bx, \Bx') = \frac{1}{2 \pi} \ln \Abs{\Bx - \Bx'}.
}
\end{equation}

\subsection{Verifying the 2D Laplacian Green's function.}
Let's try to verify that this Green's function is correct, since we've had lots of opportunities to screw up signs (and more!)  We want to evaluate the Laplacian of the convolution and if all goes well, it should be \( V(\Bx) \).  That is
\begin{equation}\label{eqn:helmholtzGreens:1060}
\begin{aligned}
\spacegrad^2 \int G(\Bx, \Bx') V(\Bx') d^2 \Bx'
&= \inv{2 \pi} \int \spacegrad^2 \ln \Abs{\Bx - \Bx'} V(\Bx') d^2 \Bx' \\
&= \inv{2 \pi}
\int V(\Bx') \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} d^2 \Bx' \\
\end{aligned}
\end{equation}
We can verify that \( \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} \) is zero whenever \( \Abs{\Bx - \Bx'} \ne 0 \).  A nice way of doing that is in polar coordinates.  Write
\begin{equation}\label{eqn:helmholtzGreens:1160}
\begin{aligned}
\Br &= \Bx' - \Bx \\
r &= \Abs{r} \\
\end{aligned}
\end{equation}
and recall that
\begin{equation}\label{eqn:helmholtzGreens:1180}
\spacegrad^2 f = \inv{r} \PD{r}{} \lr{ r \PD{r}{f} } + \frac{\partial^2 f}{\partial \theta^2},
\end{equation}
but \( r \PD{r}{\ln r} = 1 \), and \( \ln r \) has no angular dependence.  That means that
\begin{equation}\label{eqn:helmholtzGreens:1200}
\spacegrad^2 \int G(\Bx, \Bx') V(\Bx') d^2 \Bx'
= \inv{2 \pi} \int_{\Abs{\Bx - \Bx'} < \epsilon} V(\Bx') \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} d^2 \Bx',
\end{equation}
where we let \( \epsilon \rightarrow 0 \).  Such a region is illustrated in \cref{fig:neighborhoodOfX:neighborhoodOfXFig7}.
\imageFigure{../figures/blogit/neighborhoodOfXFig7}{Neighborhood \( \Abs{\Bx - \Bx'} < \epsilon \)}{fig:neighborhoodOfX:neighborhoodOfXFig7}{0.3}

We can now apply Green's theorem, which for 2D is
\begin{equation}\label{eqn:helmholtzGreens:1080}
\int_A \lr{ u \spacegrad^2 v - v \spacegrad^2 u } dA = \int_{\partial A} \lr{ u \spacegrad v - v \spacegrad u } \cdot \ncap dS,
\end{equation}
or
\begin{equation}\label{eqn:helmholtzGreens:1090}
\int_A v \spacegrad^2 u \, dA = \int_A u \spacegrad^2 v \, dA -\int_{\partial A} \lr{ u \spacegrad v - v \spacegrad u } \cdot \ncap dS,
\end{equation}
With
\begin{equation}\label{eqn:helmholtzGreens:1161}
\begin{aligned}
\rcap &= \Br/r = \ncap \\
u &= \ln r \\
v &= V(\Bx') \\
dA &= r dr d\theta \\
dS &= r d\theta,
\end{aligned}
\end{equation}
we have
\begin{equation}\label{eqn:helmholtzGreens:1100}
\begin{aligned}
\int V(\Bx') \lr{ \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} } d^2 \Bx'
&=
\int_{r=0}^\epsilon r dr d\theta \ln r \lr{ \spacegrad'}^2 V(\Bx') \\
&\quad-
    \int_{\theta = 0}^{2 \pi}
\epsilon d\theta
\evalbar{
\lr{
    \ln \epsilon \spacegrad' V(\Bx') - V(\Bx') \spacegrad' \ln r
}
\cdot \rcap
}
{r = \epsilon}
\end{aligned}
\end{equation}
We have \( r \ln r \), or \( \epsilon \ln \epsilon \) dependence in two of the integrand terms, and with \( r < \epsilon \), and \( \epsilon \ln \epsilon \rightarrow 0 \), in the limit, we are left with
\begin{equation}\label{eqn:helmholtzGreens:1120}
\begin{aligned}
\int V(\Bx') \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} d^2 \Bx'
&=
\int_{\theta = 0}^{2 \pi} \epsilon \evalbar{ d\theta V(\Bx') \lr{ \spacegrad' \ln r } \cdot \rcap }{r = \epsilon} \\
&=
\int_{\theta = 0}^{2 \pi}
\epsilon
\evalbar{
d\theta V(\Bx') \lr{ \lr{ \rcap \partial_r + \frac{\thetacap}{r^2} \partial_\theta } \ln r } \cdot \rcap
}{r = \epsilon}
\\
&=
\int_{\theta = 0}^{2 \pi}
\epsilon
\evalbar{
d\theta V(\Bx') \frac{\rcap}{r} \cdot \rcap
}{r = \epsilon}
\\
&=
\int_{\theta = 0}^{2 \pi} d\theta V(\Bx + \epsilon \rcap).
\end{aligned}
\end{equation}

In the limit we are left with just \( 2 \pi V(\Bx) \), so
\begin{equation}\label{eqn:helmholtzGreens:1140}
\spacegrad^2 \int G(\Bx, \Bx') V(\Bx') d^2 \Bx' = V(\Bx),
\end{equation}
as desired.

\section{3D Green's function.}
The 3D Green's function that we wish to try to evaluate is
\begin{equation}\label{eqn:helmholtzGreens:540}
G(\Br) = -\inv{(2 \pi)^3} \int \frac{e^{j \Bp \cdot \Br}}{\Bp^2 - k^2} d^3 p.
\end{equation}
We will have to displace the pole again, but we will get to that in a bit.  First let's make a spherical change of variables to evaluate the integral, with
\begin{equation}\label{eqn:helmholtzGreens:560}
\begin{aligned}
\Bp &= p \lr{ \sin\alpha \cos\phi, \sin\alpha \sin\phi, \cos\alpha } \\
\Br &= \Abs{\Br} \Be_3.
\end{aligned}
\end{equation}
This gives
\begin{equation}\label{eqn:helmholtzGreens:580}
G(\Br)
= -\inv{(2 \pi)^3} \int_0^\infty p^2 dp \int_0^\pi \sin\alpha d\alpha \int_0^{2 \pi} d\phi \frac{e^{j p \Abs{\Br} \cos\alpha}}{p^2 - k^2}.
\end{equation}
Let \( t = \cos\alpha \), to find
\begin{equation}\label{eqn:helmholtzGreens:600}
\begin{aligned}
G(\Br)
&= -\inv{(2 \pi)^2} \int_0^\infty p^2 dp \int_1^{-1} (-dt) \frac{e^{j p \Abs{\Br} t}}{p^2 - k^2} \\
&= \inv{(2 \pi)^2} \int_0^\infty p^2 dp \evalrange{\frac{e^{j p \Abs{\Br} t}}{\lr{p^2 - k^2} j p \Abs{\Br}}}{1}{-1} \\
&= \inv{j (2 \pi)^2 \Abs{\Br}} \int_0^\infty p dp \frac{e^{-j p \Abs{\Br}} - e^{j p \Abs{\Br}} }{p^2 - k^2} \\
&= -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{p^2 - k^2} \\
&\sim -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{p^2 - \lr{k + j \epsilon}^2}.
\end{aligned}
\end{equation}
In the last step, we've displaced the pole so that we can evaluate it using an infinite upper half plane semicircular contour, as illustrated in \cref{fig:greensHelmholtz:greensHelmholtzFig1ab}.
%\imageTwoFigures{../figures/blogit/greensHelmholtzFig1a}{../figures/blogit/greensHelmholtzFig1b}{Contours for 3D Green's function evaluation}{fig:greensHelmholtz:greensHelmholtzFig1ab}{scale=0.7}
%\cref{fig:greensHelmholtz:greensHelmholtzFig1b}.
Which pole we choose depends on the sign we pick for the ``small'' pole displacement \( \epsilon \).  For the \( \epsilon > 0 \) case, we find
\begin{equation}\label{eqn:helmholtzGreens:620}
\begin{aligned}
G(\Br)
&= -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{\lr{p - (k + j \epsilon)}\lr{p - (-k - j \epsilon)}} \\
&= -\frac{2 \pi j}{j (2 \pi)^2 \Abs{\Br}} \evalbar{\frac{p e^{j p \Abs{\Br}} }{p + k + j \epsilon}}{p = k + j \epsilon} \\
&= -\frac{1}{2 \pi \Abs{\Br}} (k + j \epsilon) \frac{e^{j (k + j \epsilon) \Abs{\Br}} }{2 (k + j \epsilon)} \\
&= -\frac{1}{4 \pi \Abs{\Br}} e^{j k \Abs{\Br}} e^{-\epsilon \Abs{\Br}}  \\
&\rightarrow -\frac{e^{j k \Abs{\Br}} }{4 \pi \Abs{\Br}}.
\end{aligned}
\end{equation}
whereas for \( \epsilon < 0 \), we have
\begin{equation}\label{eqn:helmholtzGreens:640}
\begin{aligned}
G(\Br)
&= -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{\lr{p - (k + j \epsilon)}\lr{p - (-k - j \epsilon)}} \\
&= -\frac{2 \pi j}{j (2 \pi)^2 \Abs{\Br}} \evalbar{\frac{p e^{j p \Abs{\Br}} }{p - k - j \epsilon}}{p = -k - j \epsilon} \\
&= -\frac{1}{2 \pi \Abs{\Br}} (-k - j \epsilon) \frac{e^{j (-k - j \epsilon) \Abs{\Br}} }{2 (-k - j \epsilon)} \\
&= -\frac{1}{4 \pi \Abs{\Br}} e^{-j k \Abs{\Br}} e^{\epsilon \Abs{\Br}}  \\
&\rightarrow -\frac{e^{-j k \Abs{\Br}} }{4 \pi \Abs{\Br}}.
\end{aligned}
\end{equation}

The Green's function has the structure of either an outgoing or incoming spherical wave, with inverse radial amplitude:
\begin{equation}\label{eqn:helmholtzGreens:660}
\boxed{
G(\Bx, \Bx') = -\frac{e^{\pm j k \Abs{\Br}} }{4 \pi \Abs{\Br}}.
}
\end{equation}

%}
\EndArticle
