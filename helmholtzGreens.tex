%
% Copyright © 2025 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
\input{../latex/blogpost.tex}
\renewcommand{\basename}{helmholtzGreens}
%\renewcommand{\dirname}{notes/phy1520/}
\renewcommand{\dirname}{notes/ece1228-electromagnetic-theory/}
%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{}

\input{../latex/peeter_prologue_print2.tex}

\usepackage{peeters_layout_exercise}
\usepackage{peeters_braket}
\usepackage{peeters_figures}
\usepackage{siunitx}
\usepackage{verbatim}
%\usepackage{macros_cal} % \LL
%\usepackage{amsthm} % proof
%\usepackage{mhchem} % \ce{}
%\usepackage{macros_bm} % \bcM
%\usepackage{macros_qed} % \qedmarker
%\usepackage{txfonts} % \ointclockwise

\beginArtNoToc

\generatetitle{Green's functions for the Helmholtz (wave equation) operator in various dimensions}
%\chapter{Green's functions for the Helmholtz (wave equation) operator in various dimensions}
%\label{chap:helmholtzGreens}
My favorite book on mathematical physics derives the Green's function for the 3D Helmholtz (wave equation) operator.  I tried to derive the 2D Green's function the same way and had trouble.  In this series of blog posts, I'll attempt that again, but will start with the easier 1D and 3D cases.  Presuming that I don't hit any conceptual troubles trying both of those from first principles, I'll attempt the seemingly trickier 2D case again.

\section{Motivation and background.}
We seek a solution to non-homogeneous Helmholtz equation
\begin{equation}\label{eqn:helmholtzGreens:20}
0 = \lr{ \spacegrad^2 + k^2 } U(\Bx) - V(\Bx).
\end{equation}

This is a problem that can be solved using Fourier transform techniques.  Following \citep{byron1992mca}, let's write our transform pair in the symmetrical form:
\begin{equation}\label{eqn:helmholtzGreens:40}
\begin{aligned}
F(\Bx) &= \lr{\inv{\sqrt{2 \pi}}}^N \int \hat{F}(\Bp) e^{j \Bp \cdot \Bx} d\Bp \\
\hat{F}(\Bp) &= \lr{\inv{\sqrt{2 \pi}}}^N \int F(\Bx) e^{-j \Bp \cdot \Bx} d\Bx.
\end{aligned}
\end{equation}

Expressing \(U(\Bx), V(\Bx)\), in terms of their Fourier transforms, \cref{eqn:helmholtzGreens:20} becomes
\begin{equation}\label{eqn:helmholtzGreens:80}
\begin{aligned}
0 &=
\lr{ \spacegrad^2 + k^2 }
\lr{\inv{\sqrt{2 \pi}}}^N
\int \hat{U}(\Bp) e^{j \Bp \cdot \Bx} d\Bp
-
\lr{\inv{\sqrt{2 \pi}}}^N
\int \hat{V}(\Bp) e^{j \Bp \cdot \Bx} d\Bp \\
&=
\lr{\inv{\sqrt{2 \pi}}}^N
\int \lr{ \hat{U}(\Bp) \lr{ -\Bp^2 + k^2 } - \hat{V}(\Bp) } e^{j \Bp \cdot \Bx} d\Bp,
\end{aligned}
\end{equation}
which requires
\begin{equation}\label{eqn:helmholtzGreens:100}
\hat{U}(\Bp) = \frac{\hat{V}(\Bp) }{k^2 - \Bp^2}.
\end{equation}

We can now inverse transform to find \( U(\Bx) \), which gives
\begin{equation}\label{eqn:helmholtzGreens:120}
\begin{aligned}
U(\Bx) &=
\lr{\inv{\sqrt{2 \pi}}}^N \int \hat{U}(\Bp) e^{j \Bp \cdot \Bx} d\Bp \\
&=
\lr{\inv{\sqrt{2 \pi}}}^N \int
\frac{\hat{V}(\Bp) }{k^2 - \Bp^2} e^{j \Bp \cdot \Bx} d\Bp \\
&=
\lr{\inv{2 \pi}}^N \int
\inv{k^2 - \Bp^2} e^{j \Bp \cdot \Bx} d\Bp \int V(\Bx') e^{-j \Bp \cdot \Bx'} d\Bx' \\
&=
\int V(\Bx') d\Bx'
\lr{\inv{2 \pi}}^N
\int
\inv{k^2 - \Bp^2} e^{j \Bp \cdot \lr{\Bx - \Bx'}}
d\Bp
.
\end{aligned}
\end{equation}

The general solution is given by
\begin{equation}\label{eqn:helmholtzGreens:140}
U(\Bx) = \int G(\Bx, \Bx') V(\Bx') d\Bx',
\end{equation}
where \( G(\Bx, \Bx') \) is called the Green's function, and has the form
\begin{equation}\label{eqn:helmholtzGreens:160}
G(\Bx, \Bx') = \lr{\inv{2 \pi}}^N
\int
\inv{k^2 - \Bp^2} e^{j \Bp \cdot \lr{\Bx - \Bx'}}
d\Bp.
\end{equation}

Equivalently, if we presume that a solution of the form \cref{eqn:helmholtzGreens:140} can be found, and operate on that with the Helmholtz operator \( \spacegrad^2 + k^2 \), we find
\begin{equation}\label{eqn:helmholtzGreens:60}
\lr{ \spacegrad^2 + k^2 } U(\Bx) = \int \lr{ \spacegrad^2 + k^2 } G(\Bx, \Bx') V(\Bx') d\Bx' = V(\Bx),
\end{equation}
which requires that our Green's function \( G(\Bx, \Bx') \) has the functional form
\begin{equation}\label{eqn:helmholtzGreens:180}
\lr{ \spacegrad^2 + k^2 } G(\Bx, \Bx') = \delta(\Bx - \Bx').
\end{equation}
\section{Evaluating the Green's function in 1D.}
For the one dimensional case, we want to evaluate
\begin{equation}\label{eqn:helmholtzGreens:200}
G(u) = -\inv{2 \pi} \int \inv{p^2 - k^2} e^{j p u} dp,
\end{equation}
an integral which is unfortunately non-convergent.  Since we are dealing with delta functions, it is not surprising that we have convergence problems.  The technique used in the book is to displace the pole slightly by a small imaginary amount, and then take the limit.

That is
\begin{equation}\label{eqn:helmholtzGreens:220}
G(u) = \lim_{\epsilon \rightarrow 0} G_\epsilon(u),
\end{equation}
where
\begin{equation}\label{eqn:helmholtzGreens:240}
\begin{aligned}
G_\epsilon(u)
&= -\inv{2 \pi} \int_{-\infty}^\infty \inv{p^2 - \lr{k + j \epsilon}^2} e^{j p u} dp \\
&= -\inv{2 \pi} \int_{-\infty}^\infty \frac{e^{j p u}}{\lr{ p - k -j \epsilon}\lr{p + k + j \epsilon}} dp.
\end{aligned}
\end{equation}
For \( u > 0 \) we can use an upper half plane infinite semicircular contour integral, as illustrated in \cref{fig:greensHelmholtz:greensHelmholtzFig1}, where we
let \( R \rightarrow \infty \).
\imageFigure{../figures/blogit/greensHelmholtzFig1}{Contour for \( u > 0 \).}{fig:greensHelmholtz:greensHelmholtzFig1}{0.2}

The residue calculation for that contour gives
\begin{equation}\label{eqn:helmholtzGreens:260}
\begin{aligned}
G_\epsilon(u)
&= -\frac{2 \pi j}{2 \pi} \evalbar{\frac{e^{j p u}}{p + k + j \epsilon} }{p = k + j \epsilon} \\
&= -j \frac{e^{j \lr{k + j \epsilon} u}}{2\lr{k + j \epsilon}} \\
&= -j \frac{e^{j k u} e^{-\epsilon u}}{2\lr{k + j \epsilon}} \\
&\rightarrow -\frac{j}{2k} e^{j k u}.
\end{aligned}
\end{equation}

For \( u < 0 \) we can use a lower half plane infinite semicircular contour, as illustrated in \cref{fig:greensHelmholtz:greensHelmholtzFig2}.
\imageFigure{../figures/blogit/greensHelmholtzFig2}{Contour for \( u < 0 \).}{fig:greensHelmholtz:greensHelmholtzFig2}{0.3}
For this contour, we find
\begin{equation}\label{eqn:helmholtzGreens:280}
\begin{aligned}
G_\epsilon(u)
&= -\frac{2 \pi j}{2 \pi} \evalbar{\frac{e^{j p u}}{p - k - j \epsilon} }{p = -k - j \epsilon} \\
&= j \frac{e^{-j \lr{k + j \epsilon} u}}{2\lr{k + j \epsilon}} \\
&= j \frac{e^{-j k u} e^{\epsilon u}}{2\lr{k + j \epsilon}} \\
&\rightarrow \frac{j}{2k} e^{-j k u} \\
&= \frac{j}{2k} e^{j k \Abs{u}}.
\end{aligned}
\end{equation}
We find that our Green's function is
\begin{equation}\label{eqn:helmholtzGreens:300}
\boxed{
G(u) = \frac{-j \sgn(u)}{2k} e^{j k \Abs{u}}.
}
\end{equation}

Let's plug this into the convolution integral to see the form of the general solution
\begin{equation}\label{eqn:helmholtzGreens:320}
U(x) = -\frac{j}{2k} \int_{-\infty}^\infty \sgn(x - x') e^{j k \Abs{x - x'}} V(x') dx'.
\end{equation}
We want to break this integral into two regions
\begin{equation}\label{eqn:helmholtzGreens:340}
\int_{-\infty}^\infty = \int_{-\infty}^x + \int_x^\infty,
\end{equation}
separating the integral into regions where \( x > x' \) and \( x < x' \) respectively.  That is
\begin{equation}\label{eqn:helmholtzGreens:360}
U(x) =
-\frac{j}{2k} \int_{-\infty}^x e^{j k \lr{x - x'}} V(x') dx'
+\frac{j}{2k} \int_x^\infty e^{-j k \lr{x - x'}} V(x') dx'.
\end{equation}
This isn't the most general solution, as we can also add any solution to the homogeneous Helmholtz equation.  That is
\begin{equation}\label{eqn:helmholtzGreens:400}
U(x) = A e^{j k x} + B e^{-j k x} - \frac{j}{2k} \int_{-\infty}^x e^{j k \lr{x - x'}} V(x') dx'
+\frac{j}{2k} \int_x^\infty e^{-j k \lr{x - x'}} V(x') dx'.
\end{equation}

The real and imaginary parts of this equation must also be independent solutions.  For example, taking the real parts, we find the following general solution
\begin{equation}\label{eqn:helmholtzGreens:380}
U(x) =
A' \cos\lr{ k x } +
B' \sin\lr{ k x }
+\inv{2} \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'
-\inv{2} \int_x^\infty \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'.
\end{equation}

\subsection{A strictly causal solution.}
It is interesting that the specific solution above has equal causal and acausal contributions.  Such a solution (outside of QFT) is generally undesirable.  We can construct a specific solution that is either causal or acausal by picking just one of the integrals above, instead of averaging.  For example, let
\begin{equation}\label{eqn:helmholtzGreens:440}
f(x) = \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'.
\end{equation}
We can verify that this is a specific solution to our equation using the identity
\begin{equation}\label{eqn:helmholtzGreens:460}
\frac{d}{dx} \int_a^x g(x, x') dx'
=
\evalbar{g(x, x') }{x' = x} + \int_a^x \frac{\partial g(x,x')}{dx} dx'.
\end{equation}
Taking the first derivative of \( f(x) \), we find
\begin{equation}\label{eqn:helmholtzGreens:480}
\begin{aligned}
\frac{df}{dx}
&= \evalbar{ \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') }{x' = x} + k \int_{-\infty}^x \frac{\cos\lr{k \lr{x - x'}}}{k} V(x') dx' \\
&= k \int_{-\infty}^x \frac{\cos\lr{k \lr{x - x'}}}{k} V(x') dx',
\end{aligned}
\end{equation}
where we have, somewhat lazily, treated the infinite limit as a constant.  Effectively, this requires that the forcing function \( V(x) \) is zero at \( -\infty \).  Taking the second derivative, we have
\begin{equation}\label{eqn:helmholtzGreens:500}
\begin{aligned}
\frac{d^2f}{dx^2}
&=
\evalbar{ k \frac{\cos\lr{k \lr{x - x'}}}{k} V(x') }{x' = x} - k^2 \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx' \\
&= V(x) - k^2 f(x),
\end{aligned}
\end{equation}
or
\begin{equation}\label{eqn:helmholtzGreens:520}
\frac{d^2}{dx^2} f(x) + k^2 f(x) = V(x).
\end{equation}
This verifies that \cref{eqn:helmholtzGreens:440} is also a specific solution to the wave equation, as expected and desired.

It appears that the general solution is likely of the following form
\begin{equation}\label{eqn:helmholtzGreens:380b}
U(x) =
A' \cos\lr{ k x } +
B' \sin\lr{ k x }
+\alpha \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'
-(1-\alpha)\int_x^\infty \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx',
\end{equation}
with \( \alpha \in [0,1] \).

It's pretty cool that we can completely solve the 1D forced wave equation, for any forcing function, from first principles.  Yes, I took liberties that would make a mathematician cringe, but we are telling a story, and leaving the footnotes to somebody else.

\subsection{More specific boundary constraints.}
Just as we have the freedom to add any homogeneous solution to our specific convolution based solution, we may do so for the Green's function itself.  Our process above, implicitly assumes that we are interested in infinite boundary value constraints.  Should we wish to impose different boundary constraints, we can form
\begin{equation}\label{eqn:helmholtzGreens:420}
G(u) = A e^{ j k u} + B e^{-j k u} - \frac{j \sgn(u)}{2k} e^{j k \Abs{u}},
\end{equation}
but must then use the boundary value constraints to determine the desired form of the Green's function, using the two degrees of freedom to do so.  That's also an interesting topic, and would be good to also visit in a followup post.
\section{3D Green's function.}
The 3D Green's function that we wish to try to evaluate is
\begin{equation}\label{eqn:helmholtzGreens:540}
G(\Br) = -\inv{(2 \pi)^3} \int \frac{e^{j \Bp \cdot \Br}}{\Bp^2 - k^2} d^3 p.
\end{equation}
We will have to displace the pole again, but we will get to that in a bit.  First let's make a spherical change of variables to evaluate the integral, with
\begin{equation}\label{eqn:helmholtzGreens:560}
\begin{aligned}
\Bp &= p \lr{ \sin\alpha \cos\phi, \sin\alpha \sin\phi, \cos\alpha } \\
\Br &= \Abs{\Br} \Be_3.
\end{aligned}
\end{equation}
This gives
\begin{equation}\label{eqn:helmholtzGreens:580}
G(\Br)
= -\inv{(2 \pi)^3} \int_0^\infty p^2 dp \int_0^\pi \sin\alpha d\alpha \int_0^{2 \pi} d\phi \frac{e^{j p \Abs{\Br} \cos\alpha}}{p^2 - k^2}.
\end{equation}
Let \( t = \cos\alpha \), to find
\begin{equation}\label{eqn:helmholtzGreens:600}
\begin{aligned}
G(\Br)
&= -\inv{(2 \pi)^2} \int_0^\infty p^2 dp \int_1^{-1} (-dt) \frac{e^{j p \Abs{\Br} t}}{p^2 - k^2} \\
&= \inv{(2 \pi)^2} \int_0^\infty p^2 dp \evalrange{\frac{e^{j p \Abs{\Br} t}}{\lr{p^2 - k^2} j p \Abs{\Br}}}{1}{-1} \\
&= \inv{j (2 \pi)^2 \Abs{\Br}} \int_0^\infty p dp \frac{e^{-j p \Abs{\Br}} - e^{j p \Abs{\Br}} }{p^2 - k^2} \\
&= -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{p^2 - k^2} \\
&\sim -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{p^2 - \lr{k + j \epsilon}^2}.
\end{aligned}
\end{equation}
In the last step, we've displaced the pole so that we can evaluate it using an infinite upper half plane semicircular contour, as illustrated in \cref{fig:greensHelmholtz:greensHelmholtzFig1a}.
\imageTwoFigures{../figures/blogit/greensHelmholtzFig1a}{../figures/blogit/greensHelmholtzFig1b}
{Contours for 3D Green's function evaluation}{fig:greensHelmholtz:greensHelmholtzFig1a}{scale=0.7}
%\cref{fig:greensHelmholtz:greensHelmholtzFig1b}.
Which pole we choose depends on the sign we pick for the ``small'' pole displacement \( \epsilon \).  For the \( \epsilon > 0 \) case, we find
\begin{equation}\label{eqn:helmholtzGreens:620}
\begin{aligned}
G(\Br)
&= -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{\lr{p - (k + j \epsilon)}\lr{p - (-k - j \epsilon)}} \\
&= -\frac{2 \pi j}{j (2 \pi)^2 \Abs{\Br}} \evalbar{\frac{p e^{j p \Abs{\Br}} }{p + k + j \epsilon}}{p = k + j \epsilon} \\
&= -\frac{1}{2 \pi \Abs{\Br}} (k + j \epsilon) \frac{e^{j (k + j \epsilon) \Abs{\Br}} }{2 (k + j \epsilon)} \\
&= -\frac{1}{4 \pi \Abs{\Br}} e^{j k \Abs{\Br}} e^{-\epsilon \Abs{\Br}}  \\
&\rightarrow -\frac{e^{j k \Abs{\Br}} }{4 \pi \Abs{\Br}}.
\end{aligned}
\end{equation}
whereas for \( \epsilon < 0 \), we have
\begin{equation}\label{eqn:helmholtzGreens:640}
\begin{aligned}
G(\Br)
&= -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{\lr{p - (k + j \epsilon)}\lr{p - (-k - j \epsilon)}} \\
&= -\frac{2 \pi j}{j (2 \pi)^2 \Abs{\Br}} \evalbar{\frac{p e^{j p \Abs{\Br}} }{p - k - j \epsilon}}{p = -k - j \epsilon} \\
&= -\frac{1}{2 \pi \Abs{\Br}} (-k - j \epsilon) \frac{e^{j (-k - j \epsilon) \Abs{\Br}} }{2 (-k - j \epsilon)} \\
&= -\frac{1}{4 \pi \Abs{\Br}} e^{-j k \Abs{\Br}} e^{\epsilon \Abs{\Br}}  \\
&\rightarrow -\frac{e^{-j k \Abs{\Br}} }{4 \pi \Abs{\Br}}.
\end{aligned}
\end{equation}

The Green's function has the structure of either an outgoing or incoming spherical wave, with inverse radial amplitude:
\begin{equation}\label{eqn:helmholtzGreens:660}
\boxed{
G(\Bx, \Bx') = -\frac{e^{\pm j k \Abs{\Br}} }{4 \pi \Abs{\Br}}.
}
\end{equation}
\section{2D Green's function.}
Okay, now let's do the 2D Green's function evaluation.  Our starting place is
\begin{equation}\label{eqn:helmholtzGreens:680}
G(\Br) = -\inv{(2 \pi)^2} \int \frac{e^{j \Bp \cdot \Br}}{\Bp^2 - k^2} d^2 p.
\end{equation}
With a change of variables to polar coordinates, letting
\begin{equation}\label{eqn:helmholtzGreens:700}
\begin{aligned}
\Bp &= p \lr{ \cos\phi, \sin\phi } \\
\Br &= \Abs{\Br} \Be_2,
\end{aligned}
\end{equation}
we can make the integral explicit
\begin{equation}\label{eqn:helmholtzGreens:720}
G(\Br) = -\inv{(2 \pi)^2} \int_0^\infty \frac{p dp}{p^2 - k^2} \int_0^{2 \pi} d\phi e^{j p \Abs{\Br} \sin\phi}.
\end{equation}
Unlike the 3D case, where the angular dependence could be trivially evaluated, we are no longer so lucky.  What on earth can we do with the \( \phi \) integral?  Just like \href{https://youtu.be/mm-4PltMB2A}{Hilter's lament about ``undoable integrals in Jackson''}, we are faced with the same enemy. As it turns out, due to the cylindrical symmetry of the problem, we are also staring down the gun of Bessel functions.  Both Mathematica and Grok point out that we can evaluate integrals of this form, like so:
\begin{equation}\label{eqn:helmholtzGreens:740}
\int_0^{2 \pi} d\phi e^{j a \sin\phi} = 2 \pi J_0(a).
\end{equation}

From \citep{byron1992mca} we have two representations of \( J_n \), a series representation and integral representation
\begin{equation}\label{eqn:helmholtzGreens:760}
J_n(z) = \sum_{m=0}^\infty \frac{(-1)^m (z/2)^{2m + n}}{(n + m)!m!} = \inv{\pi} \int_0^\pi \cos(n \theta - z \sin\theta) d\theta.
\end{equation}

In particular, this means that
\begin{equation}\label{eqn:helmholtzGreens:800}
J_0(z) = \sum_{m=0}^\infty \frac{(-1)^m (z/2)^{2m}}{(m!)^2} = J_0(z) = \inv{\pi} \int_0^\pi \cos(z \sin\theta) d\theta.
\end{equation}
This is a damped sine like function, as illustrated in \cref{fig:j0:j0Fig4}.
\imageFigure{../figures/blogit/j0Fig4}{Bessel function of zeroth order.}{fig:j0:j0Fig4}{0.3}

In \S 6.9, both of these are derived from a generating function representation of the Bessel functions, and one of the intermediate steps in that construction has
\begin{equation}\label{eqn:helmholtzGreens:840}
J_n(z) = \inv{2\pi} \int_{-\pi}^\pi e^{-j(n\theta - z \sin\theta)} d\theta,
\end{equation}
where the \( [-\pi, \pi] \) range was the result of a contour integration using a unit circle parameterization, which could have also used \( [0, 2 \pi] \).  That means, sure enough, that we have
\begin{equation}\label{eqn:helmholtzGreens:860}
J_0(z) = \inv{2\pi} \int_{0}^{2\pi} e^{j z \sin\theta} d\theta,
\end{equation}
as claimed by both Grok and Mathematica.

This means that the evaluation of the Green's function is now reduced to the limit of one final integral
\begin{equation}\label{eqn:helmholtzGreens:880}
G(\Br) = -\inv{2 \pi} \int_0^\infty \frac{p J_0(p \Abs{\Br} ) dp}{p^2 - \lr{k + j \epsilon}^2},
\end{equation}
where we've also displaced the problematic pole by a small imaginary amount as before.  Grok incorrectly claimed that this was an even integral, and then argued that the end result is a Hankel function (that may be the case, but it's reasoning to get there was clearly wrong.) Mathematica, on the other hand, can evaluate this integral
\begin{equation}\label{eqn:helmholtzGreens:900}
G(\Br) = -\inv{2 \pi} K_0\lr{\frac{\Abs{\Br}}{\sqrt{\frac{1}{(\epsilon - j k)^2}}}}, \epsilon \neq 0.
\end{equation}
It's not clear to me why Mathematica writes the argument as 1 over a reciprocal root.  Perhaps that has something to do with the branch cut that Mathematica uses for it's square root function?  If I plug in representative numeric values, it simplifies in the expected way, as illustrated in \cref{fig:MathematicaWeirdArgument:MathematicaWeirdArgumentFig5}.
\imageFigure{../figures/blogit/MathematicaWeirdArgumentFig5}{Mathematica weird Bessel argument.}{fig:MathematicaWeirdArgument:MathematicaWeirdArgumentFig5}{0.1}

The take away appears to be that the limiting form of the 2D Green's function, for \( k > 0 \), is
\begin{equation}\label{eqn:helmholtzGreens:920}
G(\Bx, \Bx') = -\inv{2 \pi} K_0\lr{-j k \Abs{\Bx - \Bx'} }.
\end{equation}
A peek at \citep{abramowitz1964handbook} shows that \( K_0 \) can be expressed in terms of a Hankel function of the first kind (order 0) \( H_0^{(1)}(z) = J_0(z) + j Y_0(z) \), plotted in \cref{fig:hankelPlot:hankelPlotFig6}.
\imageFigure{../figures/blogit/hankelPlotFig6}{Hankel function of the first kind (order 0).}{fig:hankelPlot:hankelPlotFig6}{0.3}

For real positive \( \alpha \), we have
\begin{equation}\label{eqn:helmholtzGreens:940}
K_0(-j \alpha) = \frac{j\pi}{2} H_0^{(1)}(\alpha),
\end{equation}
so
\begin{equation}\label{eqn:helmholtzGreens:960}
\boxed{
G(\Bx, \Bx') = -\frac{j}{4} H_0^{(1)}(k \Abs{\Bx - \Bx'}).
}
\end{equation}
\section{A trilogy in four parts.  The 2D Laplacian Green's function.}
I was questioning the correctness of the 1D and 2D Helmholtz Green's functions derived above, since they are both seemingly malformed for \( k \rightarrow 0 \).

Let's try to carefully expand the 2D Green's function in the neighbourhood of \( k = 0 \) to validate that result, and as a side effect, obtain the Green's function for the 2D Laplacian.

In \citep{abramowitz1964handbook}, \S 9.1.7, 9.1.8, we have for \( z \rightarrow 0 \)
\begin{equation}\label{eqn:helmholtzGreens:980}
\begin{aligned}
J_\nu(z) &\sim \lr{\frac{z}{2}}^\nu/\Gamma(\nu+1) \\
Y_0(z) &\sim \frac{2}{\pi} \ln z,
\end{aligned}
\end{equation}
so for \( k \ll r \)
\begin{equation}\label{eqn:helmholtzGreens:1000}
H_0^{(1)}(k r) \sim 1 + \frac{2j}{\pi} \ln\lr{k r},
\end{equation}
and
\begin{equation}\label{eqn:helmholtzGreens:1020}
\begin{aligned}
G(\Br)
&\sim -\frac{j}{4} \lr{ 1 + \frac{j}{2 \pi} \ln\lr{k r} } \\
&= -\frac{j}{4} + \frac{1}{2 \pi} \ln k + \frac{1}{2 \pi} \ln r.
\end{aligned}
\end{equation}
Here is where we have to get sneaky.  Since we seek a Green's function for the Laplacian operator, we are free to add any solution \( f(x,y) \) that satisfies \( \spacegrad^2 f = 0 \).  Constants are clearly in that homogeneous solution space, so we may adjust this expansion of the Green's function, throwing away the leading constant imaginary term, and treating \( k \) as a small constant, the \( \ln k \) term.  That leaves us with
\begin{equation}\label{eqn:helmholtzGreens:1040}
G(\Bx, \Bx') = \frac{1}{2 \pi} \ln \Abs{\Bx - \Bx'}.
\end{equation}

%}
\EndArticle
