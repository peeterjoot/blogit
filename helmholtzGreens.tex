%
% Copyright © 2025 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
\input{../latex/blogpost.tex}
\renewcommand{\basename}{helmholtzGreens}
%\renewcommand{\dirname}{notes/phy1520/}
\renewcommand{\dirname}{notes/ece1228-electromagnetic-theory/}
%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{}

\input{../latex/peeter_prologue_print2.tex}

\usepackage{peeters_layout_exercise}
\usepackage{peeters_braket}
\usepackage{peeters_figures}
\usepackage{siunitx}
\usepackage{verbatim}
%\usepackage{macros_cal} % \LL
%\usepackage{amsthm} % proof
%\usepackage{mhchem} % \ce{}
%\usepackage{macros_bm} % \bcM
%\usepackage{macros_qed} % \qedmarker
%\usepackage{txfonts} % \ointclockwise

\beginArtNoToc

\generatetitle{Green's functions for the Helmholtz (wave equation) operator in various dimensions}
%\chapter{Green's functions for the Helmholtz (wave equation) operator in various dimensions}
%\label{chap:helmholtzGreens}
My favorite book on mathematical physics derives the Green's function for the 3D Helmholtz (wave equation) operator.  I tried to derive the 2D Green's function the same way and had trouble.  In this series of blog posts, I'll attempt that again, but will start with the easier 1D and 3D cases.  Presuming that I don't hit any conceptual troubles trying both of those from first principles, I'll attempt the seemingly trickier 2D case again.

\section{Motivation and background.}
We seek a solution to non-homogeneous Helmholtz equation
\begin{equation}\label{eqn:helmholtzGreens:20}
0 = \lr{ \spacegrad^2 + k^2 } U(\Bx) - V(\Bx).
\end{equation}

This is a problem that can be solved using Fourier transform techniques.  Following \citep{byron1992mca}, let's write our transform pair in the symmetrical form:
\begin{equation}\label{eqn:helmholtzGreens:40}
\begin{aligned}
F(\Bx) &= \lr{\inv{\sqrt{2 \pi}}}^N \int \hat{F}(\Bp) e^{j \Bp \cdot \Bx} d\Bp \\
\hat{F}(\Bp) &= \lr{\inv{\sqrt{2 \pi}}}^N \int F(\Bx) e^{-j \Bp \cdot \Bx} d\Bx.
\end{aligned}
\end{equation}

Expressing \(U(\Bx), V(\Bx)\), in terms of their Fourier transforms, \cref{eqn:helmholtzGreens:20} becomes
\begin{equation}\label{eqn:helmholtzGreens:80}
\begin{aligned}
0 &=
\lr{ \spacegrad^2 + k^2 }
\lr{\inv{\sqrt{2 \pi}}}^N
\int \hat{U}(\Bp) e^{j \Bp \cdot \Bx} d\Bp
-
\lr{\inv{\sqrt{2 \pi}}}^N
\int \hat{V}(\Bp) e^{j \Bp \cdot \Bx} d\Bp \\
&=
\lr{\inv{\sqrt{2 \pi}}}^N
\int \lr{ \hat{U}(\Bp) \lr{ -\Bp^2 + k^2 } - \hat{V}(\Bp) } e^{j \Bp \cdot \Bx} d\Bp,
\end{aligned}
\end{equation}
which requires
\begin{equation}\label{eqn:helmholtzGreens:100}
\hat{U}(\Bp) = \frac{\hat{V}(\Bp) }{k^2 - \Bp^2}.
\end{equation}

We can now inverse transform to find \( U(\Bx) \), which gives
\begin{equation}\label{eqn:helmholtzGreens:120}
\begin{aligned}
U(\Bx) &=
\lr{\inv{\sqrt{2 \pi}}}^N \int \hat{U}(\Bp) e^{j \Bp \cdot \Bx} d\Bp \\
&=
\lr{\inv{\sqrt{2 \pi}}}^N \int
\frac{\hat{V}(\Bp) }{k^2 - \Bp^2} e^{j \Bp \cdot \Bx} d\Bp \\
&=
\lr{\inv{2 \pi}}^N \int
\inv{k^2 - \Bp^2} e^{j \Bp \cdot \Bx} d\Bp \int V(\Bx') e^{-j \Bp \cdot \Bx'} d\Bx' \\
&=
\int V(\Bx') d\Bx'
\lr{\inv{2 \pi}}^N
\int
\inv{k^2 - \Bp^2} e^{j \Bp \cdot \lr{\Bx - \Bx'}}
d\Bp
.
\end{aligned}
\end{equation}

The general solution is given by
\begin{equation}\label{eqn:helmholtzGreens:140}
U(\Bx) = \int G(\Bx, \Bx') V(\Bx') d\Bx',
\end{equation}
where \( G(\Bx, \Bx') \) is called the Green's function, and has the form
\begin{equation}\label{eqn:helmholtzGreens:160}
G(\Bx, \Bx') = \lr{\inv{2 \pi}}^N
\int
\inv{k^2 - \Bp^2} e^{j \Bp \cdot \lr{\Bx - \Bx'}}
d\Bp.
\end{equation}

Equivalently, if we presume that a solution of the form \cref{eqn:helmholtzGreens:140} can be found, and operate on that with the Helmholtz operator \( \spacegrad^2 + k^2 \), we find
\begin{equation}\label{eqn:helmholtzGreens:60}
\lr{ \spacegrad^2 + k^2 } U(\Bx) = \int \lr{ \spacegrad^2 + k^2 } G(\Bx, \Bx') V(\Bx') d\Bx' = V(\Bx),
\end{equation}
which requires that our Green's function \( G(\Bx, \Bx') \) has the functional form
\begin{equation}\label{eqn:helmholtzGreens:180}
\lr{ \spacegrad^2 + k^2 } G(\Bx, \Bx') = \delta(\Bx - \Bx').
\end{equation}
\section{Evaluating the Green's function in 1D.}
For the one dimensional case, we want to evaluate
\begin{equation}\label{eqn:helmholtzGreens:200}
G(r) = -\inv{2 \pi} \int \inv{p^2 - k^2} e^{j p r} dp,
\end{equation}
an integral which is unfortunately non-convergent.  Since we are dealing with delta functions, it is not surprising that we have convergence problems.  The technique used in the book is to displace the pole slightly by a small imaginary amount, and then take the limit.

That is
\begin{equation}\label{eqn:helmholtzGreens:220}
G(r) = \lim_{\epsilon \rightarrow 0} G_\epsilon(r),
\end{equation}
where
\begin{equation}\label{eqn:helmholtzGreens:240}
\begin{aligned}
G_\epsilon(r)
&= -\inv{2 \pi} \int_{-\infty}^\infty \inv{p^2 - \lr{k + j \epsilon}^2} e^{j p r} dp \\
&= -\inv{2 \pi} \int_{-\infty}^\infty \frac{e^{j p r}}{\lr{ p - k -j \epsilon}\lr{p + k + j \epsilon}} dp.
\end{aligned}
\end{equation}
For \( r > 0 \) we can use an upper half plane infinite semicircular contour integral, as illustrated in \cref{fig:greensHelmholtz:greensHelmholtzFig1}, where we
let \( R \rightarrow \infty \).
\imageFigure{../figures/blogit/greensHelmholtzFig1}{Contour for \( r > 0 \).}{fig:greensHelmholtz:greensHelmholtzFig1}{0.2}

The residue calculation for that contour gives
\begin{equation}\label{eqn:helmholtzGreens:260}
\begin{aligned}
G_\epsilon(r)
&= -\frac{2 \pi j}{2 \pi} \evalbar{\frac{e^{j p r}}{p + k + j \epsilon} }{p = k + j \epsilon} \\
&= -j \frac{e^{j \lr{k + j \epsilon} r}}{2\lr{k + j \epsilon}} \\
&= -j \frac{e^{j k r} e^{-\epsilon r}}{2\lr{k + j \epsilon}} \\
&\rightarrow -\frac{j}{2k} e^{j k r}.
\end{aligned}
\end{equation}

For \( r < 0 \) we can use a lower half plane infinite semicircular contour, as illustrated in \cref{fig:greensHelmholtz:greensHelmholtzFig2}.
\imageFigure{../figures/blogit/greensHelmholtzFig2}{Contour for \( r < 0 \).}{fig:greensHelmholtz:greensHelmholtzFig2}{0.3}
For this contour, we find
\begin{equation}\label{eqn:helmholtzGreens:280}
\begin{aligned}
G_\epsilon(r)
&= -\frac{2 \pi j}{2 \pi} \evalbar{\frac{e^{j p r}}{p - k - j \epsilon} }{p = -k - j \epsilon} \\
&= j \frac{e^{-j \lr{k + j \epsilon} r}}{2\lr{k + j \epsilon}} \\
&= j \frac{e^{-j k r} e^{\epsilon r}}{2\lr{k + j \epsilon}} \\
&\rightarrow \frac{j}{2k} e^{-j k r} \\
&= \frac{j}{2k} e^{j k \Abs{r}}.
\end{aligned}
\end{equation}
We find that our Green's function is
\begin{equation}\label{eqn:helmholtzGreens:300}
\boxed{
G(r) = -\frac{j \sgn(r)}{2k} e^{j k \Abs{r}}.
}
\end{equation}

Let's plug this into the convolution integral to see the form of the general solution
\begin{equation}\label{eqn:helmholtzGreens:320}
U(x) = -\frac{j}{2k} \int_{-\infty}^\infty \sgn(x - x') e^{j k \Abs{x - x'}} V(x') dx'.
\end{equation}
We want to break this integral into two regions
\begin{equation}\label{eqn:helmholtzGreens:340}
\int_{-\infty}^\infty = \int_{-\infty}^x + \int_x^\infty,
\end{equation}
separating the integral into regions where \( x > x' \) and \( x < x' \) respectively.  That is
\begin{equation}\label{eqn:helmholtzGreens:360}
U(x) =
-\frac{j}{2k} \int_{-\infty}^x e^{j k \lr{x - x'}} V(x') dx'
+\frac{j}{2k} \int_x^\infty e^{-j k \lr{x - x'}} V(x') dx'.
\end{equation}
This isn't the most general solution, as we can also add any solution to the homogeneous Helmholtz equation.  That is
\begin{equation}\label{eqn:helmholtzGreens:400}
U(x) = A e^{j k x} + B e^{-j k x} - \frac{j}{2k} \int_{-\infty}^x e^{j k \lr{x - x'}} V(x') dx'
+\frac{j}{2k} \int_x^\infty e^{-j k \lr{x - x'}} V(x') dx'.
\end{equation}

The real and imaginary parts of this equation must also be independent solutions.  For example, taking the real parts, we find the following general solution
\begin{equation}\label{eqn:helmholtzGreens:380}
U(x) =
A' \cos\lr{ k x } +
B' \sin\lr{ k x }
+\inv{2} \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'
-\inv{2} \int_x^\infty \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'.
\end{equation}

\subsection{A strictly causal solution.}
It is interesting that the specific solution above has equal causal and acausal contributions.  Such a solution (outside of QFT) is generally undesirable.  We can construct a specific solution that is either causal or acausal by picking just one of the integrals above, instead of averaging.  For example, let
\begin{equation}\label{eqn:helmholtzGreens:440}
f(x) = \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'.
\end{equation}
We can verify that this is a specific solution to our equation using the identity
\begin{equation}\label{eqn:helmholtzGreens:460}
\frac{d}{dx} \int_a^x g(x, x') dx'
=
\evalbar{g(x, x') }{x' = x} + \int_a^x \frac{\partial g(x,x')}{dx} dx'.
\end{equation}
Taking the first derivative of \( f(x) \), we find
\begin{equation}\label{eqn:helmholtzGreens:480}
\begin{aligned}
\frac{df}{dx}
&= \evalbar{ \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') }{x' = x} + k \int_{-\infty}^x \frac{\cos\lr{k \lr{x - x'}}}{k} V(x') dx' \\
&= k \int_{-\infty}^x \frac{\cos\lr{k \lr{x - x'}}}{k} V(x') dx',
\end{aligned}
\end{equation}
where we have, somewhat lazily, treated the infinite limit as a constant.  Effectively, this requires that the forcing function \( V(x) \) is zero at \( -\infty \).  Taking the second derivative, we have
\begin{equation}\label{eqn:helmholtzGreens:500}
\begin{aligned}
\frac{d^2f}{dx^2}
&=
\evalbar{ k \frac{\cos\lr{k \lr{x - x'}}}{k} V(x') }{x' = x} - k^2 \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx' \\
&= V(x) - k^2 f(x),
\end{aligned}
\end{equation}
or
\begin{equation}\label{eqn:helmholtzGreens:520}
\frac{d^2}{dx^2} f(x) + k^2 f(x) = V(x).
\end{equation}
This verifies that \cref{eqn:helmholtzGreens:440} is also a specific solution to the wave equation, as expected and desired.

It appears that the general solution is likely of the following form
\begin{equation}\label{eqn:helmholtzGreens:380b}
U(x) =
A' \cos\lr{ k x } +
B' \sin\lr{ k x }
+\alpha \int_{-\infty}^x \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx'
-(1-\alpha)\int_x^\infty \frac{\sin\lr{k \lr{x - x'}}}{k} V(x') dx',
\end{equation}
with \( \alpha \in [0,1] \).

It's pretty cool that we can completely solve the 1D forced wave equation, for any forcing function, from first principles.  Yes, I took liberties that would make a mathematician cringe, but we are telling a story, and leaving the footnotes to somebody else.

\subsection{More specific boundary constraints.}
Just as we have the freedom to add any homogeneous solution to our specific convolution based solution, we may do so for the Green's function itself.  Our process above, implicitly assumes that we are interested in infinite boundary value constraints.  Should we wish to impose different boundary constraints, we can form
\begin{equation}\label{eqn:helmholtzGreens:420}
G(r) = A e^{ j k r} + B e^{-j k r} - \frac{j \sgn(r)}{2k} e^{j k \Abs{r}},
\end{equation}
but must then use the boundary value constraints to determine the desired form of the Green's function, using the two degrees of freedom to do so.  That's also an interesting topic, and would be good to also visit in a followup post.
\section{3D Green's function.}
The 3D Green's function that we wish to try to evaluate is
\begin{equation}\label{eqn:helmholtzGreens:540}
G(\Br) = -\inv{(2 \pi)^3} \int \frac{e^{j \Bp \cdot \Br}}{\Bp^2 - k^2} d^3 p.
\end{equation}
We will have to displace the pole again, but we will get to that in a bit.  First let's make a spherical change of variables to evaluate the integral, with
\begin{equation}\label{eqn:helmholtzGreens:560}
\begin{aligned}
\Bp &= p \lr{ \sin\alpha \cos\phi, \sin\alpha \sin\phi, \cos\alpha } \\
\Br &= \Abs{\Br} \Be_3.
\end{aligned}
\end{equation}
This gives
\begin{equation}\label{eqn:helmholtzGreens:580}
G(\Br)
= -\inv{(2 \pi)^3} \int_0^\infty p^2 dp \int_0^\pi \sin\alpha d\alpha \int_0^{2 \pi} d\phi \frac{e^{j p \Abs{\Br} \cos\alpha}}{p^2 - k^2}.
\end{equation}
Let \( t = \cos\alpha \), to find
\begin{equation}\label{eqn:helmholtzGreens:600}
\begin{aligned}
G(\Br)
&= -\inv{(2 \pi)^2} \int_0^\infty p^2 dp \int_1^{-1} (-dt) \frac{e^{j p \Abs{\Br} t}}{p^2 - k^2} \\
&= \inv{(2 \pi)^2} \int_0^\infty p^2 dp \evalrange{\frac{e^{j p \Abs{\Br} t}}{\lr{p^2 - k^2} j p \Abs{\Br}}}{1}{-1} \\
&= \inv{j (2 \pi)^2 \Abs{\Br}} \int_0^\infty p dp \frac{e^{-j p \Abs{\Br}} - e^{j p \Abs{\Br}} }{p^2 - k^2} \\
&= -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{p^2 - k^2} \\
&\sim -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{p^2 - \lr{k + j \epsilon}^2}.
\end{aligned}
\end{equation}
In the last step, we've displaced the pole so that we can evaluate it using an infinite upper half plane semicircular contour, as illustrated in \cref{fig:greensHelmholtz:greensHelmholtzFig1a}.
\imageTwoFigures{../figures/blogit/greensHelmholtzFig1a}{../figures/blogit/greensHelmholtzFig1b}
{Contours for 3D Green's function evaluation}{fig:greensHelmholtz:greensHelmholtzFig1a}{scale=0.7}
%\cref{fig:greensHelmholtz:greensHelmholtzFig1b}.
Which pole we choose depends on the sign we pick for the ``small'' pole displacement \( \epsilon \).  For the \( \epsilon > 0 \) case, we find
\begin{equation}\label{eqn:helmholtzGreens:620}
\begin{aligned}
G(\Br)
&= -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{\lr{p - (k + j \epsilon)}\lr{p - (-k - j \epsilon)}} \\
&= -\frac{2 \pi j}{j (2 \pi)^2 \Abs{\Br}} \evalbar{\frac{p e^{j p \Abs{\Br}} }{p + k + j \epsilon}}{p = k + j \epsilon} \\
&= -\frac{1}{2 \pi \Abs{\Br}} (k + j \epsilon) \frac{e^{j (k + j \epsilon) \Abs{\Br}} }{2 (k + j \epsilon)} \\
&= -\frac{1}{4 \pi \Abs{\Br}} e^{j k \Abs{\Br}} e^{-\epsilon \Abs{\Br}}  \\
&\rightarrow -\frac{e^{j k \Abs{\Br}} }{4 \pi \Abs{\Br}}.
\end{aligned}
\end{equation}
whereas for \( \epsilon < 0 \), we have
\begin{equation}\label{eqn:helmholtzGreens:640}
\begin{aligned}
G(\Br)
&= -\inv{j (2 \pi)^2 \Abs{\Br}} \int_{-\infty}^\infty p dp \frac{e^{j p \Abs{\Br}} }{\lr{p - (k + j \epsilon)}\lr{p - (-k - j \epsilon)}} \\
&= -\frac{2 \pi j}{j (2 \pi)^2 \Abs{\Br}} \evalbar{\frac{p e^{j p \Abs{\Br}} }{p - k - j \epsilon}}{p = -k - j \epsilon} \\
&= -\frac{1}{2 \pi \Abs{\Br}} (-k - j \epsilon) \frac{e^{j (-k - j \epsilon) \Abs{\Br}} }{2 (-k - j \epsilon)} \\
&= -\frac{1}{4 \pi \Abs{\Br}} e^{-j k \Abs{\Br}} e^{\epsilon \Abs{\Br}}  \\
&\rightarrow -\frac{e^{-j k \Abs{\Br}} }{4 \pi \Abs{\Br}}.
\end{aligned}
\end{equation}

The Green's function has the structure of either an outgoing or incoming spherical wave, with inverse radial amplitude:
\begin{equation}\label{eqn:helmholtzGreens:660}
\boxed{
G(\Bx, \Bx') = -\frac{e^{\pm j k \Abs{\Br}} }{4 \pi \Abs{\Br}}.
}
\end{equation}
\section{2D Green's function.}
Okay, now let's do the 2D Green's function evaluation.  Our starting place is
\begin{equation}\label{eqn:helmholtzGreens:680}
G(\Br) = -\inv{(2 \pi)^2} \int \frac{e^{j \Bp \cdot \Br}}{\Bp^2 - k^2} d^2 p.
\end{equation}
With a change of variables to polar coordinates, letting
\begin{equation}\label{eqn:helmholtzGreens:700}
\begin{aligned}
\Bp &= p \lr{ \cos\phi, \sin\phi } \\
\Br &= \Abs{\Br} \Be_2,
\end{aligned}
\end{equation}
we can make the integral explicit
\begin{equation}\label{eqn:helmholtzGreens:720}
G(\Br) = -\inv{(2 \pi)^2} \int_0^\infty \frac{p dp}{p^2 - k^2} \int_0^{2 \pi} d\phi e^{j p \Abs{\Br} \sin\phi}.
\end{equation}
Unlike the 3D case, where the angular dependence could be trivially evaluated, we are no longer so lucky.  What on earth can we do with the \( \phi \) integral?  Just like \href{https://youtu.be/mm-4PltMB2A}{Hilter's lament about ``undoable integrals in Jackson''}, we are faced with the same enemy. As it turns out, due to the cylindrical symmetry of the problem, we are also staring down the gun of Bessel functions.  Both Mathematica and Grok point out that we can evaluate integrals of this form, like so:
\begin{equation}\label{eqn:helmholtzGreens:740}
\int_0^{2 \pi} d\phi e^{j a \sin\phi} = 2 \pi J_0(a).
\end{equation}

From \citep{byron1992mca} we have two representations of \( J_n \), a series representation and integral representation
\begin{equation}\label{eqn:helmholtzGreens:760}
J_n(z) = \sum_{m=0}^\infty \frac{(-1)^m (z/2)^{2m + n}}{(n + m)!m!} = \inv{\pi} \int_0^\pi \cos(n \theta - z \sin\theta) d\theta.
\end{equation}

In particular, this means that
\begin{equation}\label{eqn:helmholtzGreens:800}
J_0(z) = \sum_{m=0}^\infty \frac{(-1)^m (z/2)^{2m}}{(m!)^2} = J_0(z) = \inv{\pi} \int_0^\pi \cos(z \sin\theta) d\theta.
\end{equation}
This is a damped sine like function, as illustrated in \cref{fig:j0:j0Fig4}.
\imageFigure{../figures/blogit/j0Fig4}{Bessel function of zeroth order.}{fig:j0:j0Fig4}{0.3}

In \S 6.9, both of these are derived from a generating function representation of the Bessel functions, and one of the intermediate steps in that construction has
\begin{equation}\label{eqn:helmholtzGreens:840}
J_n(z) = \inv{2\pi} \int_{-\pi}^\pi e^{-j(n\theta - z \sin\theta)} d\theta,
\end{equation}
where the \( [-\pi, \pi] \) range was the result of a contour integration using a unit circle parameterization, which could have also used \( [0, 2 \pi] \).  That means, sure enough, that we have
\begin{equation}\label{eqn:helmholtzGreens:860}
J_0(z) = \inv{2\pi} \int_{0}^{2\pi} e^{j z \sin\theta} d\theta,
\end{equation}
as claimed by both Grok and Mathematica.

This means that the evaluation of the Green's function is now reduced to the limit of one final integral
\begin{equation}\label{eqn:helmholtzGreens:880}
G(\Br) = -\inv{2 \pi} \int_0^\infty \frac{p J_0(p \Abs{\Br} ) dp}{p^2 - \lr{k + j \epsilon}^2},
\end{equation}
where we've also displaced the problematic pole by a small imaginary amount as before.  Grok incorrectly claimed that this was an even integral, and then argued that the end result is a Hankel function (that may be the case, but it's reasoning to get there was clearly wrong.) Mathematica, on the other hand, can evaluate this integral
\begin{equation}\label{eqn:helmholtzGreens:900}
G(\Br) = -\inv{2 \pi} K_0\lr{\frac{\Abs{\Br}}{\sqrt{\frac{1}{(\epsilon - j k)^2}}}}, \epsilon \neq 0.
\end{equation}
It's not clear to me why Mathematica writes the argument as 1 over a reciprocal root.  Perhaps that has something to do with the branch cut that Mathematica uses for it's square root function?  If I plug in representative numeric values, it simplifies in the expected way, as illustrated in \cref{fig:MathematicaWeirdArgument:MathematicaWeirdArgumentFig5}.
\imageFigure{../figures/blogit/MathematicaWeirdArgumentFig5}{Mathematica weird Bessel argument.}{fig:MathematicaWeirdArgument:MathematicaWeirdArgumentFig5}{0.1}

The take away appears to be that the limiting form of the 2D Green's function, for \( k > 0 \), is
\begin{equation}\label{eqn:helmholtzGreens:920}
G(\Bx, \Bx') = -\inv{2 \pi} K_0\lr{-j k \Abs{\Bx - \Bx'} }.
\end{equation}
A peek at \citep{abramowitz1964handbook} shows that \( K_0 \) can be expressed in terms of a Hankel function of the first kind (order 0) \( H_0^{(1)}(z) = J_0(z) + j Y_0(z) \), plotted in \cref{fig:hankelPlot:hankelPlotFig6}.
\imageFigure{../figures/blogit/hankelPlotFig6}{Hankel function of the first kind (order 0).}{fig:hankelPlot:hankelPlotFig6}{0.3}

For real positive \( \alpha \), we have
\begin{equation}\label{eqn:helmholtzGreens:940}
K_0(-j \alpha) = \frac{j\pi}{2} H_0^{(1)}(\alpha),
\end{equation}
so
\begin{equation}\label{eqn:helmholtzGreens:960}
\boxed{
G(\Bx, \Bx') = -\frac{j}{4} H_0^{(1)}(k \Abs{\Bx - \Bx'}).
}
\end{equation}
\section{A trilogy in four parts.  The 2D Laplacian Green's function.}
I was questioning the correctness of the 1D and 2D Helmholtz Green's functions derived above, since they are both seemingly malformed for \( k \rightarrow 0 \).

Let's try to carefully expand the 2D Green's function in the neighbourhood of \( k = 0 \) to validate that result, and as a side effect, obtain the Green's function for the 2D Laplacian.

In \citep{abramowitz1964handbook}, \S 9.1.7, 9.1.8, we have for \( z \rightarrow 0 \)
\begin{equation}\label{eqn:helmholtzGreens:980}
\begin{aligned}
J_\nu(z) &\sim \lr{\frac{z}{2}}^\nu/\Gamma(\nu+1) \\
Y_0(z) &\sim \frac{2}{\pi} \ln z,
\end{aligned}
\end{equation}
so for \( k \ll r \)
\begin{equation}\label{eqn:helmholtzGreens:1000}
H_0^{(1)}(k r) \sim 1 + \frac{2j}{\pi} \ln\lr{k r},
\end{equation}
and
\begin{equation}\label{eqn:helmholtzGreens:1020}
\begin{aligned}
G(\Br)
&\sim -\frac{j}{4} \lr{ 1 + \frac{j}{2 \pi} \ln\lr{k r} } \\
&= -\frac{j}{4} + \frac{1}{2 \pi} \ln k + \frac{1}{2 \pi} \ln r.
\end{aligned}
\end{equation}
Here is where we have to get sneaky.  Since we seek a Green's function for the Laplacian operator, we are free to add any solution \( f(x,y) \) that satisfies \( \spacegrad^2 f = 0 \).  Constants are clearly in that homogeneous solution space, so we may adjust this expansion of the Green's function, throwing away the leading constant imaginary term, and treating \( k \) as a small constant, the \( \ln k \) term.  That leaves us with
\begin{equation}\label{eqn:helmholtzGreens:1040}\boxed{
G(\Bx, \Bx') = \frac{1}{2 \pi} \ln \Abs{\Bx - \Bx'}.
}
\end{equation}

\subsection{Verifying the 2D Laplacian Green's function.}
Let's try to verify that this Green's function is correct, since we've had lots of opportunities to screw up signs (and more!)  We want to evaluate the Laplacian of the convolution and if all goes well, it should be \( V(\Bx) \).  That is
\begin{equation}\label{eqn:helmholtzGreens:1060}
\begin{aligned}
\spacegrad^2 \int G(\Bx, \Bx') V(\Bx') d^2 \Bx'
&= \inv{2 \pi} \int \spacegrad^2 \ln \Abs{\Bx - \Bx'} V(\Bx') d^2 \Bx' \\
&= \inv{2 \pi}
\int V(\Bx') \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} d^2 \Bx' \\
\end{aligned}
\end{equation}
We can verify that \( \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} \) is zero whenever \( \Abs{\Bx - \Bx'} \ne 0 \).  A nice way of doing that is in polar coordinates.  Write
\begin{equation}\label{eqn:helmholtzGreens:1160}
\begin{aligned}
\Br &= \Bx' - \Bx \\
r &= \Abs{r} \\
\end{aligned}
\end{equation}
and recall that
\begin{equation}\label{eqn:helmholtzGreens:1180}
\spacegrad^2 f = \inv{r} \PD{r}{} \lr{ r \PD{r}{f} } + \frac{\partial^2 f}{\partial \theta^2},
\end{equation}
but \( r \PD{r}{\ln r} = 1 \), and \( \ln r \) has no angular dependence.  That means that
\begin{equation}\label{eqn:helmholtzGreens:1200}
\spacegrad^2 \int G(\Bx, \Bx') V(\Bx') d^2 \Bx'
= \inv{2 \pi} \int_{\Abs{\Bx - \Bx'} < \epsilon} V(\Bx') \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} d^2 \Bx',
\end{equation}
where we let \( \epsilon \rightarrow 0 \).  Such a region is illustrated in \cref{fig:neighborhoodOfX:neighborhoodOfXFig7}.
\imageFigure{../figures/blogit/neighborhoodOfXFig7}{Neighborhood \( \Abs{\Bx - \Bx'} < \epsilon \)}{fig:neighborhoodOfX:neighborhoodOfXFig7}{0.3}

We can now apply Green's theorem, which for 2D is
\begin{equation}\label{eqn:helmholtzGreens:1080}
\int_A \lr{ u \spacegrad^2 v - v \spacegrad^2 u } dA = \int_{\partial A} \lr{ u \spacegrad v - v \spacegrad u } \cdot \ncap dS,
\end{equation}
or
\begin{equation}\label{eqn:helmholtzGreens:1090}
\int_A v \spacegrad^2 u \, dA = \int_A u \spacegrad^2 v \, dA -\int_{\partial A} \lr{ u \spacegrad v - v \spacegrad u } \cdot \ncap dS,
\end{equation}
With
\begin{equation}\label{eqn:helmholtzGreens:1161}
\begin{aligned}
\rcap &= \Br/r = \ncap \\
u &= \ln r \\
v &= V(\Bx') \\
dA &= r dr d\theta \\
dS &= r d\theta,
\end{aligned}
\end{equation}
we have
\begin{equation}\label{eqn:helmholtzGreens:1100}
\begin{aligned}
\int V(\Bx') \lr{ \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} } d^2 \Bx'
&=
\int_{r=0}^\epsilon r dr d\theta \ln r \lr{ \spacegrad'}^2 V(\Bx') \\
&\quad-
    \int_{\theta = 0}^{2 \pi}
\epsilon d\theta
\evalbar{
\lr{
    \ln \epsilon \spacegrad' V(\Bx') - V(\Bx') \spacegrad' \ln r
}
\cdot \rcap
}
{r = \epsilon}
\end{aligned}
\end{equation}
We have \( r \ln r \), or \( \epsilon \ln \epsilon \) dependence in two of the integrand terms, and with \( r < \epsilon \), and \( \epsilon \ln \epsilon \rightarrow 0 \), in the limit, we are left with
\begin{equation}\label{eqn:helmholtzGreens:1120}
\begin{aligned}
\int V(\Bx') \lr{\spacegrad'}^2 \ln \Abs{\Bx - \Bx'} d^2 \Bx'
&=
\int_{\theta = 0}^{2 \pi} \epsilon \evalbar{ d\theta V(\Bx') \lr{ \spacegrad' \ln r } \cdot \rcap }{r = \epsilon} \\
&=
\int_{\theta = 0}^{2 \pi}
\epsilon
\evalbar{
d\theta V(\Bx') \lr{ \lr{ \rcap \partial_r + \frac{\thetacap}{r^2} \partial_\theta } \ln r } \cdot \rcap
}{r = \epsilon}
\\
&=
\int_{\theta = 0}^{2 \pi}
\epsilon
\evalbar{
d\theta V(\Bx') \frac{\rcap}{r} \cdot \rcap
}{r = \epsilon}
\\
&=
\int_{\theta = 0}^{2 \pi} d\theta V(\Bx + \epsilon \rcap).
\end{aligned}
\end{equation}

In the limit we are left with just \( 2 \pi V(\Bx) \), so
\begin{equation}\label{eqn:helmholtzGreens:1140}
\spacegrad^2 \int G(\Bx, \Bx') V(\Bx') d^2 \Bx' = V(\Bx),
\end{equation}
as desired.

\section{Revisiting the 1D Helmholtz Green's function.}
\subsection{Confirming an error in the derived 1D Helmholtz Green's function.}
The discontinuity in the derived 1D Helmholtz Green's function is somewhat surprising.  Let's try to verify that this works or find what does.  The first thing to check is that
\begin{equation}\label{eqn:helmholtzGreens:1220}
\lr{ \spacegrad^2 + k^2} G(x,x') = 0,
\end{equation}
at locations where \( x \ne x' \).  Since we are avoiding the origin (where the annoying sign function kicks in), means that we want to evaluate:
\begin{equation}\label{eqn:helmholtzGreens:1240}
\lr{ k^2 + \frac{d^2}{dx^2} } e^{j k \Abs{x - x'}},
\end{equation}
and expect that this will be zero.  Let's make a change of variables \( r = x' - x \), and evaluate
\begin{equation}\label{eqn:helmholtzGreens:1260}
\lr{ k^2 + \frac{d^2}{dr^2} } e^{j k \Abs{r}},
\end{equation}
assuming that we are omitting a neighbourhood around \( r = 0 \) where the absolute value causes trouble.  For \( r > 0 \)
\begin{equation}\label{eqn:helmholtzGreens:1280}
\begin{aligned}
\frac{d}{dr} e^{j k \Abs{r}}
&= \frac{d}{dr} e^{j k r} \\
&= j k e^{j k r},
\end{aligned}
\end{equation}
and
\begin{equation}\label{eqn:helmholtzGreens:1300}
\begin{aligned}
\frac{d^2}{dr^2} e^{j k \Abs{r}}
&= \frac{d}{dr} j k e^{j k r} \\
&= (j k)^2 e^{j k r}.
\end{aligned}
\end{equation}
Similarly, for \( r < 0 \), we have
\begin{equation}\label{eqn:helmholtzGreens:1320}
\frac{d^2}{dr^2} e^{j k \Abs{r}} = (-jk)^2 e^{j k \Abs{r}}.
\end{equation}
In both cases, provided we are in a neighbourhood that omits \( r \ne 0 \), we have
\begin{equation}\label{eqn:helmholtzGreens:1340}
\lr{ k^2 + \frac{d^2}{dr^2} } e^{j k \Abs{r}} = 0,
\end{equation}
as desired.

The takeaway is that we have
\begin{equation}\label{eqn:helmholtzGreens:1360}
\begin{aligned}
\lr{ \spacegrad^2 + k^2 }\int_{-\infty}^\infty G(x, x') V(x') dx'
&=
\int_{\Abs{x' - x} \le \epsilon} V(x') \lr{ \frac{d^2}{d{x'}^2} + k^2 } G(x, x') dx' \\
&=
\int_{-\epsilon}^\epsilon V(x + r) \lr{ \frac{d^2}{dr^2} + k^2 } G(r = x' - x) dr \\
\end{aligned}
\end{equation}
for some arbitrarily small value of \( \epsilon \).  Observe that after bringing the operator into the integral, we also made a change of variables, first to \( x' \) for the Laplacian, and then to \( r = x' - x \).

We'd like the 1D equivalent of Green's theorem to reduce this, so let's work that out first.
\begin{equation}\label{eqn:helmholtzGreens:1380}
\begin{aligned}
\int dx\, v \frac{d^2 u}{dx^2} - \int dx\, u \frac{d^2 v}{dx^2}
&=
\int dx\,
\lr{
    \frac{d}{dx} \lr{
        v \frac{du}{dx}
    }
- \frac{dv}{dx} \frac{du}{dx}
}
-
\int dx\,
\lr{
    \frac{d}{dx} \lr{
        u \frac{dv}{dx}
    }
    -
    \frac{du}{dx} \frac{dv}{dx}
}
\\
&=
\int dx\,
    \frac{d}{dx}
    \lr{
        v \frac{du}{dx}
    }
-
\int dx\,
    \frac{d}{dx} \lr{
        u \frac{dv}{dx}
    }
\\
&=
v \frac{du}{dx}
-
u \frac{dv}{dx},
\end{aligned}
\end{equation}
so
\begin{equation}\label{eqn:helmholtzGreens:1400}
\boxed{
    \int_a^b dx\, v \frac{d^2 u}{dx^2}
    =
    \int_a^b dx\, u \frac{d^2 v}{dx^2}
    +
    \evalrange{v \frac{du}{dx}}{a}{b}
    -
    \evalrange{u \frac{dv}{dx}}{a}{b}.
}
\end{equation}

Let's try applying that to the function \( G(r) = e^{j k \Abs{r} } \), and see what happens.  That is
\begin{equation}\label{eqn:helmholtzGreens:1420}
\begin{aligned}
\lr{ \spacegrad^2 + k^2 }\int_{\Abs{x'- x} \le \epsilon} e^{j k \Abs{x - x'}} V(x') dx'
&=
\int_{-\epsilon}^\epsilon e^{j k \Abs{r}} \lr{ k^2 + \frac{d^2}{dr^2} } V(x + r) dr \\
&\quad +
\evalrange{ V(x + r) \frac{d}{dr} e^{j k \Abs{r}} }{-\epsilon}{\epsilon}
-
\evalrange{ e^{j k \Abs{r}} \frac{d}{dr} V(x+r) }{-\epsilon}{\epsilon}.
\end{aligned}
\end{equation}
If we can assume that \( V \) and it's first and second derivatives are all continuous over this small interval, then the first integral is approximately
\begin{equation}\label{eqn:helmholtzGreens:1440}
\begin{aligned}
\int_{-\epsilon}^\epsilon e^{j k \Abs{r}} \lr{ k^2 + \frac{d^2}{dr^2} } V(x + r) dr
&\sim
\lr{ \lr{ k^2 + \frac{d^2}{dr^2} } V(x + r) }
\int_{-\epsilon}^\epsilon e^{j k \Abs{r}} dr \\
&=
\frac{2 j}{k} \lr{ 1 - e^{ j k \epsilon} }
\lr{ \lr{ k^2 + \frac{d^2}{dr^2} } V(x + r) } \\
&\rightarrow 0.
\end{aligned}
\end{equation}
Similarly, with \( dV/dr \) continuity condition, that last term is also zero.  We are left, for \( \epsilon \) sufficiently small, we are left with
\begin{equation}\label{eqn:helmholtzGreens:1460}
\lr{ \spacegrad^2 + k^2 }\int_{\Abs{x'- x} \le \epsilon} e^{j k \Abs{x - x'}} V(x') dx'
=
V(x) \evalrange{ \frac{d}{dr} e^{j k \Abs{r}} }{-\epsilon}{\epsilon}.
\end{equation}
but this is an extremely problematic derivative around the origin.  The core problem is evaluating
\begin{equation}\label{eqn:helmholtzGreens:1480}
\frac{d}{dr} e^{j k \Abs{r}} = j k e^{j k \Abs{r} } \frac{d\Abs{r}}{dr}.
\end{equation}
In conventional mathematics, we'd have to say that this is undefined at the origin.  In physics, on the other hand, where we play fast and loose with the mathematics, we express the absolute value in terms of Heavyside theta functions
\begin{equation}\label{eqn:helmholtzGreens:1500}
\Abs{r} = r \Theta(r) - r \Theta(-r).
\end{equation}
We may now take derivatives
\begin{equation}\label{eqn:helmholtzGreens:1520}
\begin{aligned}
\Abs{r}'
&= \Theta(r) - \Theta(-r) + r \delta(r) + r \delta(-r) \\
&= \sgn(r) + 2 r \delta(r).
\end{aligned}
\end{equation}
Evaluating \( e^{j k \Abs{r} } \Abs{r}' \) over the \( [-\epsilon, \epsilon] \) range, we have
\begin{equation}\label{eqn:helmholtzGreens:1540}
\begin{aligned}
\evalrange{
e^{j k \Abs{r} } \Abs{r}'
}{-\epsilon}{\epsilon}
&=
e^{j k \epsilon} \lr{ \evalrange{ \sgn(r) + 2 r \delta(r) }{-\epsilon}{\epsilon} } \\
&=
e^{j k \epsilon} \lr{ 2 + 2 \epsilon \delta(\epsilon) }.
\end{aligned}
\end{equation}
Again, playing fast and loose, we evaluate this range before taking the limit, where \( \delta(\epsilon) = 0 \) for \( \epsilon > 0 \).  We are left with
\begin{equation}\label{eqn:helmholtzGreens:1560}
\lim_{\epsilon \rightarrow 0} \lr{ \spacegrad^2 + k^2 }\int_{\Abs{x'- x} \le \epsilon} e^{j k \Abs{x - x'}} V(x') dx'
=
2 j k V(x),
\end{equation}
provided \( V \) and its first and second derivatives are continuous.

Under those constraints, the implication is that one valid Green's function for the 1D Helmholtz operator is
\begin{equation}\label{eqn:helmholtzGreens:1580}
G(r) = -\frac{j}{2k} e^{j k \Abs{r} }.
\end{equation}
The \( \sgn(r) \) scale factor that was part of the Green's function that we derived using contour integration does not appear to be required.

What happens if we retain the sign function factor?  Doing so, we have
\begin{equation}\label{eqn:helmholtzGreens:1600}
\begin{aligned}
\lr{ \spacegrad^2 + k^2 }\int_{\Abs{x'- x} \le \epsilon} \sgn(x - x') e^{j k \Abs{x - x'}} V(x') dx'
&=
-\int_{-\epsilon}^\epsilon \sgn(r) e^{j k \Abs{r}} \lr{ k^2 + \frac{d^2}{dr^2} } V(x + r) dr \\
&\quad
-
\evalrange{ V(x + r) \frac{d}{dr} \sgn(r) e^{j k \Abs{r}} }{-\epsilon}{\epsilon}
+
\evalrange{ \sgn(r) e^{j k \Abs{r}} \frac{d}{dr} V(x+r) }{-\epsilon}{\epsilon}.
\end{aligned}
\end{equation}
This time, we note that
\begin{equation}\label{eqn:helmholtzGreens:1620}
\int_{-\epsilon}^\epsilon \sgn(r) e^{j k \Abs{r}} dr = 0, \quad \forall \epsilon \ne 0,
\end{equation}
even without evaluating the limit.  However, we have problems with the other two terms.  The last term doesn't zero out as desired, instead
\begin{equation}\label{eqn:helmholtzGreens:1640}
\evalrange{ \sgn(r) e^{j k \Abs{r}} \frac{d}{dr} V(x+r) }{-\epsilon}{\epsilon} \rightarrow 2 V'(x).
\end{equation}
To evaluate the \( V(x) \) factor, we write
\begin{equation}\label{eqn:helmholtzGreens:1660}
\sgn(r) = \Theta(r) - \Theta(-r),
\end{equation}
so
\begin{equation}\label{eqn:helmholtzGreens:1680}
\begin{aligned}
\sgn(r)'
&= \delta(r) + \delta(-r) \\
&= 2 \delta(r).
\end{aligned}
\end{equation}
That means that
\begin{equation}\label{eqn:helmholtzGreens:1700}
\begin{aligned}
\frac{d}{dr} \lr{ \sgn(r) e^{j k \Abs{r}} }
&=
2 \delta(r) e^{j k \Abs{r}} + j k \sgn(r) e^{j k \Abs{r}} \lr{ \sgn(r) + 2 r \delta(r) } \\
&=
e^{j k \Abs{r}} \lr{ 2 \delta(r) + j k \lr{ 1 + 2 r \sgn(r) \delta(r)} } \\
&=
j k e^{j k \Abs{r}},
\end{aligned}
\end{equation}
for \( r \ne 0 \), so
\begin{equation}\label{eqn:helmholtzGreens:1760}
-
\evalrange{ V(x + r) \frac{d}{dr} \sgn(r) e^{j k \Abs{r}} }{-\epsilon}{\epsilon}
\rightarrow V(x) j k \lr{ e^{j k \epsilon} - e^{j k \epsilon} } = 0.
\end{equation}

All in, we are left with
\begin{equation}\label{eqn:helmholtzGreens:1720}
\lim_{\epsilon \rightarrow 0} \lr{ \spacegrad^2 + k^2 }\int_{\Abs{x'- x} \le \epsilon} \frac{(-j)}{2k} \sgn(x - x') e^{j k \Abs{x - x'}} V(x') dx'
= -\frac{j}{k} V'(x),
\end{equation}
but for a Green's function, we expected just \( V(x) \).

It seems that the sign factor in the contour integration result \cref{eqn:helmholtzGreens:300} is definitively wrong.  Instead, we want just
\begin{equation}\label{eqn:helmholtzGreens:1740}
\boxed{
G(r) = -\frac{j}{2k} e^{j k \Abs{r}}.
}
\end{equation}

Unfortunately, I don't see any errors in the original contour integration, so I'm at a loss where things went wrong.
\subsection{1D Laplacian Green's function.}
Having blundered our way to what appears to be the correct Green's function for the 1D Helmholtz operator, let's further validate that by deriving the Green's function for the 1D Laplacian.  We should also be able to verify that it has the correct delta function semantics.

Expanding the Helmholtz Green's function in series around \( k \Abs{r} \) we have
\begin{equation}\label{eqn:helmholtzGreens:1780}
\begin{aligned}
G(r)
&= -\frac{j}{2k} \lr{ 1 + j k \Abs{r} + O((k \Abs{r})^2) } \\
&= -\frac{j}{2} \lr{ \inv{k} + j \Abs{r} + \inv{k} O((k \Abs{r})^2) } \\
\end{aligned}
\end{equation}
This means that to first order in \( k \), we have
\begin{equation}\label{eqn:helmholtzGreens:1800}
G(r) + \frac{j}{2k} = \frac{\Abs{r}}{2}.
\end{equation}
As before, we are free to add constant terms to the Green's function for the Laplacian, and we conclude that the 1D Green's function for the Laplacian is
\begin{equation}\label{eqn:helmholtzGreens:1820}
\boxed{
G(r) = \frac{\Abs{r}}{2}.
}
\end{equation}

We can now attempt to validate that this has the desired delta function semantics, operating on the convolution with the Laplacian.  We are interested in evaluating
\begin{equation}\label{eqn:helmholtzGreens:1840}
\spacegrad^2 \int \frac{\Abs{x - x'}}{2} V(x') dx' = \int V(x + r) \frac{d^2}{dr^2} \frac{\Abs{r}}{2} dr.
\end{equation}
If all goes well, this should evaluate to \( V(x) \), indicating that \( \spacegrad^2 \Abs{x - x'}/2 = \delta(x - x') \).  As a first step, we expect \( \spacegrad^2 G = 0 \), for \( x \ne x' \).  Consider first \( r > 0 \), where
\begin{equation}\label{eqn:helmholtzGreens:1860}
\frac{d}{dr} \Abs{r}
=
\frac{d}{dr} r
= 1,
\end{equation}
and for \( r < 0 \) where
\begin{equation}\label{eqn:helmholtzGreens:1880}
\frac{d}{dr} \Abs{r}
=
\frac{d}{dr} (-r)
= -1.
\end{equation}
This means that, away from the origin \( d\Abs{r}/dr = \sgn(r) \), and \( d^2 \Abs{r}/dr^2 = 0\).  We can conclude that, for some non-zero positive epsilon that we will eventually let approach zero, we have
\begin{equation}\label{eqn:helmholtzGreens:1900}
\begin{aligned}
\spacegrad^2 \int \frac{\Abs{x - x'}}{2} V(x') dx'
&= \int_{-\epsilon}^\epsilon V(x + r) \frac{d^2}{dr^2} \frac{\Abs{r}}{2} dr \\
&= \int_{-\epsilon}^\epsilon \lr{
    \frac{d}{dr} \lr{ V(x + r) \frac{d}{dr} \frac{\Abs{r}}{2} }
    - \frac{dV(x + r)}{dr} \frac{d}{dr} \frac{\Abs{r}}{2}
}
dr \\
&=
\evalrange{ V(x + r) \frac{d}{dr} \frac{\Abs{r}}{2} }{-\epsilon}{\epsilon}
- \int_{-\epsilon}^\epsilon
\lr{
\frac{d}{dr} \lr{ \frac{dV(x + r)}{dr} \frac{\Abs{r}}{2} }
-
\frac{d^2V(x + r)}{dr^2} \frac{\Abs{r}}{2}
} dr \\
&=
\evalrange{ V(x + r) \frac{d}{dr} \frac{\Abs{r}}{2} }{-\epsilon}{\epsilon}
-\evalrange{ \frac{dV(x + r)}{dr} \frac{\Abs{r}}{2} }{-\epsilon}{\epsilon}
+
\int_{-\epsilon}^\epsilon \frac{d^2V(x + r)}{dr^2} \frac{\Abs{r}}{2} dr \\
&=
\inv{2} \lr{ V(x + \epsilon) + V(x - \epsilon) } \\
&-\quad \frac{\epsilon}{2}\lr{
    \frac{dV(x + \epsilon)}{dr}
    -
    \frac{dV(x - \epsilon)}{dr}
} \\
&+
\frac{\epsilon^2}{2} \lr{
    \frac{d^2V(x + \epsilon)}{dr^2}
    +
    \frac{d^2V(x + \epsilon)}{dr^2}
}.
\end{aligned}
\end{equation}
In the limit we have
\begin{equation}\label{eqn:helmholtzGreens:1920}
\boxed{
\spacegrad^2 \int G(x, x') V(x') dx' = \inv{2} \lr{ V(x^+) + V(x^-) }.
}
\end{equation}

If the test (or driving) function is continuous at \( x' = x \), then this is exactly the delta-function semantics that we expect of a Green's function.  It's interesting that this check provides us with precise semantics for the Green's function for discontinuous functions too.

%}
\EndArticle
